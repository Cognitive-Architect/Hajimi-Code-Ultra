{"numFailedTestSuites":6,"numFailedTests":26,"numPassedTestSuites":4,"numPassedTests":236,"numPendingTestSuites":0,"numPendingTests":0,"numRuntimeErrorTestSuites":0,"numTodoTests":0,"numTotalTestSuites":10,"numTotalTests":262,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1771053868335,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-001: Pattern 验证与加载"],"duration":19,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-001: Pattern 验证与加载 TEST-FAB-001-01: 应成功加载有效的 Pattern","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"TEST-FAB-001-01: 应成功加载有效的 Pattern"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-001: Pattern 验证与加载"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-001: Pattern 验证与加载 TEST-FAB-001-02: 应验证 Pattern ID 不能为空","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-FAB-001-02: 应验证 Pattern ID 不能为空"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-001: Pattern 验证与加载"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-001: Pattern 验证与加载 TEST-FAB-001-03: 应验证 Pattern 名称不能为空","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-FAB-001-03: 应验证 Pattern 名称不能为空"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-001: Pattern 验证与加载"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-001: Pattern 验证与加载 TEST-FAB-001-04: 应验证 Pattern 类型不能为空","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-FAB-001-04: 应验证 Pattern 类型不能为空"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-001: Pattern 验证与加载"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-001: Pattern 验证与加载 TEST-FAB-001-05: 应验证模板不能为空","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-FAB-001-05: 应验证模板不能为空"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-002: 依赖检查"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-002: 依赖检查 TEST-FAB-002-01: 应先加载依赖 Pattern","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-FAB-002-01: 应先加载依赖 Pattern"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-002: 依赖检查"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-002: 依赖检查 TEST-FAB-002-02: 缺少依赖时应失败","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"TEST-FAB-002-02: 缺少依赖时应失败"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-002: 依赖检查"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-002: 依赖检查 TEST-FAB-002-03: loadMany 应批量加载多个 Pattern","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-FAB-002-03: loadMany 应批量加载多个 Pattern"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-003: 模板渲染"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-003: 模板渲染 TEST-FAB-003-01: 应正确渲染模板变量","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-FAB-003-01: 应正确渲染模板变量"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-003: 模板渲染"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-003: 模板渲染 TEST-FAB-003-02: 缺少必填变量时应失败","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-FAB-003-02: 缺少必填变量时应失败"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-003: 模板渲染"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-003: 模板渲染 TEST-FAB-003-03: 应支持直接传递 Pattern 对象渲染","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-FAB-003-03: 应支持直接传递 Pattern 对象渲染"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-003: 模板渲染"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-003: 模板渲染 TEST-FAB-003-04: 渲染不存在的 Pattern 应失败","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-FAB-003-04: 渲染不存在的 Pattern 应失败"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-003: 模板渲染"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-003: 模板渲染 TEST-FAB-003-05: 应支持异步加载并渲染","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-FAB-003-05: 应支持异步加载并渲染"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-004: 变量默认值"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-004: 变量默认值 TEST-FAB-004-01: 应使用提供的变量值","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-FAB-004-01: 应使用提供的变量值"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-004: 变量默认值"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-004: 变量默认值 TEST-FAB-004-02: 未提供值时应使用默认值","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-FAB-004-02: 未提供值时应使用默认值"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-004: 变量默认值"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-004: 变量默认值 TEST-FAB-004-03: 应返回使用的变量值","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-FAB-004-03: 应返回使用的变量值"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-005: Token 估算与 Pattern 信息"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-005: Token 估算与 Pattern 信息 TEST-FAB-005-01: 应正确估算 Token 数量","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"TEST-FAB-005-01: 应正确估算 Token 数量"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-005: Token 估算与 Pattern 信息"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-005: Token 估算与 Pattern 信息 TEST-FAB-005-02: 应返回已存在的 Pattern 信息","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"TEST-FAB-005-02: 应返回已存在的 Pattern 信息"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-005: Token 估算与 Pattern 信息"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-005: Token 估算与 Pattern 信息 TEST-FAB-005-03: 应返回不存在的 Pattern 信息","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"TEST-FAB-005-03: 应返回不存在的 Pattern 信息"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","FAB-005: Token 估算与 Pattern 信息"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) FAB-005: Token 估算与 Pattern 信息 TEST-FAB-005-04: Token 估算应随内容长度变化","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"TEST-FAB-005-04: Token 估算应随内容长度变化"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","边界条件测试"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) 边界条件测试 应处理空模板","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应处理空模板"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","边界条件测试"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) 边界条件测试 应处理特殊字符模板","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应处理特殊字符模板"},{"ancestorTitles":["Fabric Loader (Pattern Loader)","边界条件测试"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric Loader (Pattern Loader) 边界条件测试 应处理嵌套变量","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应处理嵌套变量"}],"endTime":1771053871388,"message":"","name":"F:\\Hajimi Code Ultra\\tests\\unit\\fabric-loader.test.ts","startTime":1771053870081,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["API Auth","API-001: 统一错误格式"],"duration":15,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-001: 统一错误格式 should create APIError with correct structure","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"should create APIError with correct structure"},{"ancestorTitles":["API Auth","API-001: 统一错误格式"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-001: 统一错误格式 should convert APIError to JSON correctly","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"should convert APIError to JSON correctly"},{"ancestorTitles":["API Auth","API-001: 统一错误格式"],"duration":9,"failureDetails":[{"code":"ERR_INVALID_ARG_TYPE"}],"failureMessages":["TypeError: The first argument must be of type string or an instance of Buffer, ArrayBuffer, or Array or an Array-like Object. Received an instance of ReadableStream\n    at Buffer.from (node:buffer:331:9)\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\unit\\auth.test.ts:86:20)\n    at Promise.then.completed (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"API Auth API-001: 统一错误格式 should handle Zod validation errors","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should handle Zod validation errors"},{"ancestorTitles":["API Auth","API-001: 统一错误格式"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-001: 统一错误格式 should create success response with correct structure","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should create success response with correct structure"},{"ancestorTitles":["API Auth","API-001: 统一错误格式"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-001: 统一错误格式 should handle standard Error instances","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle standard Error instances"},{"ancestorTitles":["API Auth","API-001: 统一错误格式"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-001: 统一错误格式 should handle unknown errors","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle unknown errors"},{"ancestorTitles":["API Auth","API-002: Token认证"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-002: Token认证 should extract token from Authorization header","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should extract token from Authorization header"},{"ancestorTitles":["API Auth","API-002: Token认证"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-002: Token认证 should extract token from query parameter","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should extract token from query parameter"},{"ancestorTitles":["API Auth","API-002: Token认证"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-002: Token认证 should extract token from cookie","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should extract token from cookie"},{"ancestorTitles":["API Auth","API-002: Token认证"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-002: Token认证 should return null when no token is present","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return null when no token is present"},{"ancestorTitles":["API Auth","API-002: Token认证"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-002: Token认证 should generate valid token","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should generate valid token"},{"ancestorTitles":["API Auth","API-002: Token认证"],"duration":33,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-002: Token认证 should throw error for empty agent ID","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw error for empty agent ID"},{"ancestorTitles":["API Auth","API-002: Token认证"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-002: Token认证 should throw error for invalid role","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw error for invalid role"},{"ancestorTitles":["API Auth","API-002: Token认证"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-002: Token认证 should verify valid token","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should verify valid token"},{"ancestorTitles":["API Auth","API-002: Token认证"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-002: Token认证 should reject invalid token format","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should reject invalid token format"},{"ancestorTitles":["API Auth","API-002: Token认证"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-002: Token认证 should reject token with invalid role","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should reject token with invalid role"},{"ancestorTitles":["API Auth","API-002: Token认证"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-002: Token认证 should reject token with invalid timestamp","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should reject token with invalid timestamp"},{"ancestorTitles":["API Auth","API-002: Token认证"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-002: Token认证 should reject expired token","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should reject expired token"},{"ancestorTitles":["API Auth","API-002: Token认证"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-002: Token认证 should accept token within 24 hours","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should accept token within 24 hours"},{"ancestorTitles":["API Auth","API-003: 角色权限拦截"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-003: 角色权限拦截 should build correct auth context for PM","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should build correct auth context for PM"},{"ancestorTitles":["API Auth","API-003: 角色权限拦截"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-003: 角色权限拦截 should check permission correctly","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should check permission correctly"},{"ancestorTitles":["API Auth","API-003: 角色权限拦截"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-003: 角色权限拦截 should check role level correctly","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should check role level correctly"},{"ancestorTitles":["API Auth","API-003: 角色权限拦截"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-003: 角色权限拦截 should have correct role hierarchy","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"should have correct role hierarchy"},{"ancestorTitles":["API Auth","API-003: 角色权限拦截"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-003: 角色权限拦截 should have correct permission mappings","invocations":1,"location":null,"numPassingAsserts":8,"retryReasons":[],"status":"passed","title":"should have correct permission mappings"},{"ancestorTitles":["API Auth","API-003: 角色权限拦截"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-003: 角色权限拦截 should create requireRole config","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should create requireRole config"},{"ancestorTitles":["API Auth","API-003: 角色权限拦截"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-003: 角色权限拦截 should create requirePermission config","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should create requirePermission config"},{"ancestorTitles":["API Auth","API-003: 角色权限拦截"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-003: 角色权限拦截 should create requireMinLevel config","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should create requireMinLevel config"},{"ancestorTitles":["API Auth","API-004: Zod请求验证"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-004: Zod请求验证 should validate simple schema","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should validate simple schema"},{"ancestorTitles":["API Auth","API-004: Zod请求验证"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-004: Zod请求验证 should reject invalid data","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should reject invalid data"},{"ancestorTitles":["API Auth","API-004: Zod请求验证"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-004: Zod请求验证 should provide detailed validation errors","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should provide detailed validation errors"},{"ancestorTitles":["API Auth","API-004: Zod请求验证"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-004: Zod请求验证 should validate agent role enum","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should validate agent role enum"},{"ancestorTitles":["API Auth","API-004: Zod请求验证"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-004: Zod请求验证 should validate complex nested objects","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should validate complex nested objects"},{"ancestorTitles":["API Auth","API-005: 错误代码分类"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-005: 错误代码分类 should have correct common error codes","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"should have correct common error codes"},{"ancestorTitles":["API Auth","API-005: 错误代码分类"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-005: 错误代码分类 should have correct A2A error codes","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should have correct A2A error codes"},{"ancestorTitles":["API Auth","API-005: 错误代码分类"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-005: 错误代码分类 should have correct state machine error codes","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should have correct state machine error codes"},{"ancestorTitles":["API Auth","API-005: 错误代码分类"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-005: 错误代码分类 should have correct governance error codes","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should have correct governance error codes"},{"ancestorTitles":["API Auth","API-005: 错误代码分类"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-005: 错误代码分类 should have correct storage error codes","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should have correct storage error codes"},{"ancestorTitles":["API Auth","API-005: 错误代码分类"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-005: 错误代码分类 should have correct error severity levels","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should have correct error severity levels"},{"ancestorTitles":["API Auth","API-005: 错误代码分类"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-005: 错误代码分类 should create not found error","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should create not found error"},{"ancestorTitles":["API Auth","API-005: 错误代码分类"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-005: 错误代码分类 should create unauthorized error","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should create unauthorized error"},{"ancestorTitles":["API Auth","API-005: 错误代码分类"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-005: 错误代码分类 should create forbidden error","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should create forbidden error"},{"ancestorTitles":["API Auth","API-005: 错误代码分类"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-005: 错误代码分类 should create validation error","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should create validation error"},{"ancestorTitles":["API Auth","API-005: 错误代码分类"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth API-005: 错误代码分类 should create internal error","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should create internal error"},{"ancestorTitles":["API Auth","withAuth Middleware"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth withAuth Middleware should reject request without token","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should reject request without token"},{"ancestorTitles":["API Auth","withAuth Middleware"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"API Auth withAuth Middleware should reject request with invalid token","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should reject request with invalid token"},{"ancestorTitles":["API Auth","withAuth Middleware"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth withAuth Middleware should reject request with disallowed role","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should reject request with disallowed role"},{"ancestorTitles":["API Auth","withAuth Middleware"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth withAuth Middleware should reject request with insufficient permissions","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should reject request with insufficient permissions"},{"ancestorTitles":["API Auth","withAuth Middleware"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"API Auth withAuth Middleware should reject request with insufficient level","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should reject request with insufficient level"},{"ancestorTitles":["API Auth","withAuth Middleware"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth withAuth Middleware should allow request with valid token and permissions","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should allow request with valid token and permissions"},{"ancestorTitles":["API Auth","withOptionalAuth Middleware"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth withOptionalAuth Middleware should allow request without token","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should allow request without token"},{"ancestorTitles":["API Auth","withOptionalAuth Middleware"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth withOptionalAuth Middleware should provide auth context when token is valid","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should provide auth context when token is valid"},{"ancestorTitles":["API Auth","withOptionalAuth Middleware"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Auth withOptionalAuth Middleware should handle invalid token gracefully","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle invalid token gracefully"}],"endTime":1771053871461,"message":"  ● API Auth ? API-001: 统一错误格式 ? should handle Zod validation errors\n\n    TypeError: The first argument must be of type string or an instance of Buffer, ArrayBuffer, or Array or an Array-like Object. Received an instance of ReadableStream\n\n    \u001b[0m \u001b[90m 84 |\u001b[39m           \u001b[90m// 解析 JSON 响应体\u001b[39m\n     \u001b[90m 85 |\u001b[39m           \u001b[36mconst\u001b[39m body \u001b[33m=\u001b[39m \u001b[33mJSON\u001b[39m\u001b[33m.\u001b[39mparse(\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 86 |\u001b[39m             \u001b[33mBuffer\u001b[39m\u001b[33m.\u001b[39m\u001b[36mfrom\u001b[39m(response\u001b[33m.\u001b[39mbody \u001b[36mas\u001b[39m unknown \u001b[36mas\u001b[39m \u001b[33mArrayBuffer\u001b[39m)\u001b[33m.\u001b[39mtoString()\n     \u001b[90m    |\u001b[39m                    \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 87 |\u001b[39m           )\u001b[33m;\u001b[39m\n     \u001b[90m 88 |\u001b[39m\n     \u001b[90m 89 |\u001b[39m           expect(response\u001b[33m.\u001b[39mstatus)\u001b[33m.\u001b[39mtoBe(\u001b[35m400\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      at Object.<anonymous> (tests/unit/auth.test.ts:86:20)\n","name":"F:\\Hajimi Code Ultra\\tests\\unit\\auth.test.ts","startTime":1771053870029,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-001: Pattern JSON解析"],"duration":21,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-001: Pattern JSON解析 FAB-001-01: 每个角色装备可正确加载","invocations":1,"location":null,"numPassingAsserts":8,"retryReasons":[],"status":"passed","title":"FAB-001-01: 每个角色装备可正确加载"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-001: Pattern JSON解析"],"duration":16,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-001: Pattern JSON解析 FAB-001-02: Pattern结构完整（id, type, name, version, template, variables, config）","invocations":1,"location":null,"numPassingAsserts":126,"retryReasons":[],"status":"passed","title":"FAB-001-02: Pattern结构完整（id, type, name, version, template, variables, config）"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-001: Pattern JSON解析"],"duration":22,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-001: Pattern JSON解析 FAB-001-03: 变量定义正确解析","invocations":1,"location":null,"numPassingAsserts":231,"retryReasons":[],"status":"passed","title":"FAB-001-03: 变量定义正确解析"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-001: Pattern JSON解析"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-001: Pattern JSON解析 FAB-001-04: 依赖关系正确解析","invocations":1,"location":null,"numPassingAsserts":21,"retryReasons":[],"status":"passed","title":"FAB-001-04: 依赖关系正确解析"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-001: Pattern JSON解析"],"duration":8,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-001: Pattern JSON解析 FAB-001-05: 配置对象结构正确","invocations":1,"location":null,"numPassingAsserts":84,"retryReasons":[],"status":"passed","title":"FAB-001-05: 配置对象结构正确"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-001: Pattern JSON解析"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-001: Pattern JSON解析 FAB-001-06: 批量加载功能正常","invocations":1,"location":null,"numPassingAsserts":15,"retryReasons":[],"status":"passed","title":"FAB-001-06: 批量加载功能正常"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-002: Token限制验证"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-002: Token限制验证 FAB-002-01: PM角色(Soyorin) Token限制为2000","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"FAB-002-01: PM角色(Soyorin) Token限制为2000"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-002: Token限制验证"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-002: Token限制验证 FAB-002-02: 架构师角色(CucumberMu) Token限制为2000","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"FAB-002-02: 架构师角色(CucumberMu) Token限制为2000"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-002: Token限制验证"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-002: Token限制验证 FAB-002-03: 工程师角色(TangYin) Token限制为2000","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"FAB-002-03: 工程师角色(TangYin) Token限制为2000"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-002: Token限制验证"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-002: Token限制验证 FAB-002-04: QA角色 Token限制为1500","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"FAB-002-04: QA角色 Token限制为1500"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-002: Token限制验证"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-002: Token限制验证 FAB-002-05: 客服和审计角色 Token限制为1500","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"FAB-002-05: 客服和审计角色 Token限制为1500"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-002: Token限制验证"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-002: Token限制验证 FAB-002-06: 压缩比率配置正确（0.25）","invocations":1,"location":null,"numPassingAsserts":7,"retryReasons":[],"status":"passed","title":"FAB-002-06: 压缩比率配置正确（0.25）"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-002: Token限制验证"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-002: Token限制验证 FAB-002-07: TTL配置正确（3600000ms）","invocations":1,"location":null,"numPassingAsserts":7,"retryReasons":[],"status":"passed","title":"FAB-002-07: TTL配置正确（3600000ms）"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-002: Token限制验证"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-002: Token限制验证 FAB-002-08: Token估算功能正常工作","invocations":1,"location":null,"numPassingAsserts":14,"retryReasons":[],"status":"passed","title":"FAB-002-08: Token估算功能正常工作"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-003: 角色上下文切换"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-003: 角色上下文切换 FAB-003-01: Pattern渲染器正常工作","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"FAB-003-01: Pattern渲染器正常工作"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-003: 角色上下文切换"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-003: 角色上下文切换 FAB-003-02: 变量插值正确","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"FAB-003-02: 变量插值正确"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-003: 角色上下文切换"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-003: 角色上下文切换 FAB-003-03: 变量默认值生效","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"FAB-003-03: 变量默认值生效"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-003: 角色上下文切换"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-003: 角色上下文切换 FAB-003-04: 必填变量缺失时返回错误","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"FAB-003-04: 必填变量缺失时返回错误"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-003: 角色上下文切换"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-003: 角色上下文切换 FAB-003-05: 角色切换时上下文隔离","invocations":1,"location":null,"numPassingAsserts":7,"retryReasons":[],"status":"passed","title":"FAB-003-05: 角色切换时上下文隔离"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-003: 角色上下文切换"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-003: 角色上下文切换 FAB-003-06: 从注册表加载并渲染","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"FAB-003-06: 从注册表加载并渲染"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-003: 角色上下文切换"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-003: 角色上下文切换 FAB-003-07: 不存在的Pattern返回错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"FAB-003-07: 不存在的Pattern返回错误"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-003: 角色上下文切换"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-003: 角色上下文切换 FAB-003-08: getPatternInfo返回正确信息","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"FAB-003-08: getPatternInfo返回正确信息"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","FAB-003: 角色上下文切换"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 FAB-003: 角色上下文切换 FAB-003-09: 缓存机制正常工作","invocations":1,"location":null,"numPassingAsserts":7,"retryReasons":[],"status":"passed","title":"FAB-003-09: 缓存机制正常工作"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","验证报告: 所有角色装备验证"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 验证报告: 所有角色装备验证 生成完整的验证报告","invocations":1,"location":null,"numPassingAsserts":28,"retryReasons":[],"status":"passed","title":"生成完整的验证报告"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","验证报告: 所有角色装备验证"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 验证报告: 所有角色装备验证 统计信息正确","invocations":1,"location":null,"numPassingAsserts":9,"retryReasons":[],"status":"passed","title":"统计信息正确"},{"ancestorTitles":["Fabric 角色装备验证 - 工单 B-06/09","验证报告: 所有角色装备验证"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Fabric 角色装备验证 - 工单 B-06/09 验证报告: 所有角色装备验证 各角色类型统计","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"各角色类型统计"},{"ancestorTitles":["测试覆盖统计"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"测试覆盖统计 测试覆盖统计报告","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"测试覆盖统计报告"}],"endTime":1771053871482,"message":"","name":"F:\\Hajimi Code Ultra\\tests\\unit\\fabric-roles-validation.test.ts","startTime":1771053870077,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["A2A","A2A-001: 发送消息"],"duration":21,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-001: 发送消息 should send a message successfully and return complete message object","invocations":1,"location":null,"numPassingAsserts":8,"retryReasons":[],"status":"passed","title":"should send a message successfully and return complete message object"},{"ancestorTitles":["A2A","A2A-001: 发送消息"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-001: 发送消息 should persist message to TSA correctly","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should persist message to TSA correctly"},{"ancestorTitles":["A2A","A2A-001: 发送消息"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-001: 发送消息 should generate correct message ID and timestamp","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should generate correct message ID and timestamp"},{"ancestorTitles":["A2A","A2A-001: 发送消息"],"duration":34,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-001: 发送消息 should return error when TSA persistence fails","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return error when TSA persistence fails"},{"ancestorTitles":["A2A","A2A-001: 发送消息"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-001: 发送消息 should generate unique message IDs","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should generate unique message IDs"},{"ancestorTitles":["A2A","A2A-001: 发送消息"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-001: 发送消息 should generate unique session ID when not provided","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should generate unique session ID when not provided"},{"ancestorTitles":["A2A","A2A-001: 发送消息"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-001: 发送消息 should use provided session ID","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should use provided session ID"},{"ancestorTitles":["A2A","A2A-001: 发送消息"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-001: 发送消息 should support different message types","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should support different message types"},{"ancestorTitles":["A2A","A2A-001: 发送消息"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-001: 发送消息 should default to chat type when not specified","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should default to chat type when not specified"},{"ancestorTitles":["A2A","A2A-001: 发送消息"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-001: 发送消息 should store message metadata","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should store message metadata"},{"ancestorTitles":["A2A","A2A-002: 消息历史查询"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-002: 消息历史查询 should retrieve message history with pagination","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should retrieve message history with pagination"},{"ancestorTitles":["A2A","A2A-002: 消息历史查询"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-002: 消息历史查询 should support pagination with page and pageSize parameters","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"should support pagination with page and pageSize parameters"},{"ancestorTitles":["A2A","A2A-002: 消息历史查询"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-002: 消息历史查询 should sort messages in descending order by timestamp (default)","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should sort messages in descending order by timestamp (default)"},{"ancestorTitles":["A2A","A2A-002: 消息历史查询"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-002: 消息历史查询 should sort messages in ascending order by timestamp","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should sort messages in ascending order by timestamp"},{"ancestorTitles":["A2A","A2A-002: 消息历史查询"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-002: 消息历史查询 should return correct hasNext and hasPrev flags for pagination","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"should return correct hasNext and hasPrev flags for pagination"},{"ancestorTitles":["A2A","A2A-002: 消息历史查询"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-002: 消息历史查询 should handle empty results gracefully","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should handle empty results gracefully"},{"ancestorTitles":["A2A","A2A-002: 消息历史查询"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-002: 消息历史查询 should retrieve specific message by ID","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should retrieve specific message by ID"},{"ancestorTitles":["A2A","A2A-002: 消息历史查询"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-002: 消息历史查询 should return null for non-existent message","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return null for non-existent message"},{"ancestorTitles":["A2A","A2A-003: SecondMe适配"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-003: SecondMe适配 should identify SecondMe Agent ID with secondme: prefix","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should identify SecondMe Agent ID with secondme: prefix"},{"ancestorTitles":["A2A","A2A-003: SecondMe适配"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-003: SecondMe适配 should call adapter chat method with correct parameters","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should call adapter chat method with correct parameters"},{"ancestorTitles":["A2A","A2A-003: SecondMe适配"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-003: SecondMe适配 should handle adapter response correctly","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"should handle adapter response correctly"},{"ancestorTitles":["A2A","A2A-003: SecondMe适配"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-003: SecondMe适配 should handle adapter error gracefully","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle adapter error gracefully"},{"ancestorTitles":["A2A","A2A-003: SecondMe适配"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-003: SecondMe适配 should complete chat successfully","invocations":1,"location":null,"numPassingAsserts":7,"retryReasons":[],"status":"passed","title":"should complete chat successfully"},{"ancestorTitles":["A2A","A2A-003: SecondMe适配"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-003: SecondMe适配 should return assistant message","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should return assistant message"},{"ancestorTitles":["A2A","A2A-003: SecondMe适配"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-003: SecondMe适配 should pass health check","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should pass health check"},{"ancestorTitles":["A2A","A2A-003: SecondMe适配"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-003: SecondMe适配 should support chat completion with message history","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should support chat completion with message history"},{"ancestorTitles":["A2A","A2A-004: 流式消息发送"],"duration":115,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-004: 流式消息发送 should trigger streaming message sending","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should trigger streaming message sending"},{"ancestorTitles":["A2A","A2A-004: 流式消息发送"],"duration":64,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-004: 流式消息发送 should call onChunk callback with correct parameters","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should call onChunk callback with correct parameters"},{"ancestorTitles":["A2A","A2A-004: 流式消息发送"],"duration":120,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-004: 流式消息发送 should have final chunk with done=true and correct messageId","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should have final chunk with done=true and correct messageId"},{"ancestorTitles":["A2A","A2A-004: 流式消息发送"],"duration":248,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-004: 流式消息发送 should stream content in chunks correctly","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should stream content in chunks correctly"},{"ancestorTitles":["A2A","A2A-004: 流式消息发送"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-004: 流式消息发送 should support SecondMe stream chat","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should support SecondMe stream chat"},{"ancestorTitles":["A2A","A2A-004: 流式消息发送"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"A2A A2A-004: 流式消息发送 should reconstruct full content from stream chunks","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should reconstruct full content from stream chunks"},{"ancestorTitles":["A2A","Message Subscription"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"A2A Message Subscription should notify subscribers when message is sent","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should notify subscribers when message is sent"},{"ancestorTitles":["A2A","Message Subscription"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"A2A Message Subscription should allow unsubscribe","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should allow unsubscribe"}],"endTime":1771053871965,"message":"","name":"F:\\Hajimi Code Ultra\\tests\\unit\\a2a.test.ts","startTime":1771053870059,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["StateMachine","STM-001: 获取当前状态"],"duration":4074,"failureDetails":[{"matcherResult":{"actual":"DESIGN","expected":"IDLE","message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: \"IDLE\"\nReceived: \"DESIGN\"","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: \"IDLE\"\nReceived: \"DESIGN\"\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\unit\\state-machine.test.ts:27:30)\n    at Promise.then.completed (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"StateMachine STM-001: 获取当前状态 should return current state and history","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"failed","title":"should return current state and history"},{"ancestorTitles":["StateMachine","STM-002: 合法流转IDLE→DESIGN"],"duration":19,"failureDetails":[],"failureMessages":[],"fullName":"StateMachine STM-002: 合法流转IDLE→DESIGN should allow IDLE to DESIGN transition by pm","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should allow IDLE to DESIGN transition by pm"},{"ancestorTitles":["StateMachine","STM-002: 合法流转IDLE→DESIGN"],"duration":19,"failureDetails":[],"failureMessages":[],"fullName":"StateMachine STM-002: 合法流转IDLE→DESIGN should allow IDLE to DESIGN transition by arch","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should allow IDLE to DESIGN transition by arch"},{"ancestorTitles":["StateMachine","STM-003: 合法流转DESIGN→CODE"],"duration":24,"failureDetails":[],"failureMessages":[],"fullName":"StateMachine STM-003: 合法流转DESIGN→CODE should allow DESIGN to CODE transition by engineer","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should allow DESIGN to CODE transition by engineer"},{"ancestorTitles":["StateMachine","STM-003: 合法流转DESIGN→CODE"],"duration":14,"failureDetails":[],"failureMessages":[],"fullName":"StateMachine STM-003: 合法流转DESIGN→CODE should allow DESIGN to CODE transition by arch","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should allow DESIGN to CODE transition by arch"},{"ancestorTitles":["StateMachine","STM-004: 非法流转被拒绝"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"StateMachine STM-004: 非法流转被拒绝 should reject IDLE to DEPLOY transition","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should reject IDLE to DEPLOY transition"},{"ancestorTitles":["StateMachine","STM-004: 非法流转被拒绝"],"duration":29,"failureDetails":[],"failureMessages":[],"fullName":"StateMachine STM-004: 非法流转被拒绝 should reject DONE to any state transition","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should reject DONE to any state transition"},{"ancestorTitles":["StateMachine","STM-005: 状态历史记录完整"],"duration":13,"failureDetails":[],"failureMessages":[],"fullName":"StateMachine STM-005: 状态历史记录完整 should maintain complete history","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"should maintain complete history"},{"ancestorTitles":["StateMachine","STM-006: 订阅通知机制"],"duration":12,"failureDetails":[],"failureMessages":[],"fullName":"StateMachine STM-006: 订阅通知机制 should notify subscribers on state change","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should notify subscribers on state change"},{"ancestorTitles":["StateMachine","STM-006: 订阅通知机制"],"duration":10,"failureDetails":[],"failureMessages":[],"fullName":"StateMachine STM-006: 订阅通知机制 should allow unsubscribe","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should allow unsubscribe"},{"ancestorTitles":["StateMachine","STM-007: 权限验证"],"duration":13,"failureDetails":[],"failureMessages":[],"fullName":"StateMachine STM-007: 权限验证 should reject CODE to AUDIT by pm","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should reject CODE to AUDIT by pm"},{"ancestorTitles":["StateMachine","STM-008: 完整流转链路"],"duration":25,"failureDetails":[],"failureMessages":[],"fullName":"StateMachine STM-008: 完整流转链路 should complete full workflow IDLE→DESIGN→CODE→AUDIT→BUILD→DEPLOY→DONE","invocations":1,"location":null,"numPassingAsserts":14,"retryReasons":[],"status":"passed","title":"should complete full workflow IDLE→DESIGN→CODE→AUDIT→BUILD→DEPLOY→DONE"},{"ancestorTitles":["TransitionRulesEngine"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"TransitionRulesEngine should validate transitions correctly","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should validate transitions correctly"},{"ancestorTitles":["TransitionRulesEngine"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"TransitionRulesEngine should return required approvals","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should return required approvals"}],"endTime":1771053876126,"message":"  ● StateMachine ? STM-001: 获取当前状态 ? should return current state and history\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: \"IDLE\"\n    Received: \"DESIGN\"\n\n    \u001b[0m \u001b[90m 25 |\u001b[39m       expect(response)\u001b[33m.\u001b[39mtoHaveProperty(\u001b[32m'history'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m 26 |\u001b[39m       expect(response)\u001b[33m.\u001b[39mtoHaveProperty(\u001b[32m'timestamp'\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 27 |\u001b[39m       expect(response\u001b[33m.\u001b[39mstate)\u001b[33m.\u001b[39mtoBe(\u001b[32m'IDLE'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                              \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 28 |\u001b[39m       expect(\u001b[33mArray\u001b[39m\u001b[33m.\u001b[39misArray(response\u001b[33m.\u001b[39mhistory))\u001b[33m.\u001b[39mtoBe(\u001b[36mtrue\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m 29 |\u001b[39m     })\u001b[33m;\u001b[39m\n     \u001b[90m 30 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[0m\n\n      at Object.<anonymous> (tests/unit/state-machine.test.ts:27:30)\n","name":"F:\\Hajimi Code Ultra\\tests\\unit\\state-machine.test.ts","startTime":1771053870057,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["API Integration Flow","End-to-End Workflow"],"duration":4077,"failureDetails":[{"matcherResult":{"expected":true,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: true\nReceived: undefined","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: true\nReceived: undefined\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\api-flow.test.ts:71:38)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)"],"fullName":"API Integration Flow End-to-End Workflow should complete full governance workflow with state transition","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should complete full governance workflow with state transition"},{"ancestorTitles":["API Integration Flow","End-to-End Workflow"],"duration":12,"failureDetails":[{}],"failureMessages":["Error: Only PM can create proposals\n    at VoteService.createProposal (F:\\Hajimi Code Ultra\\lib\\core\\governance\\vote-service.ts:73:13)\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\api-flow.test.ts:92:42)\n    at Promise.then.completed (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"API Integration Flow End-to-End Workflow should handle A2A communication during governance","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should handle A2A communication during governance"},{"ancestorTitles":["API Integration Flow","End-to-End Workflow"],"duration":12,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Flow End-to-End Workflow should enforce auth in integrated scenarios","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should enforce auth in integrated scenarios"},{"ancestorTitles":["API Integration Flow","State Machine and Governance Integration"],"duration":8,"failureDetails":[{}],"failureMessages":["Error: Only PM can create proposals\n    at VoteService.createProposal (F:\\Hajimi Code Ultra\\lib\\core\\governance\\vote-service.ts:73:13)\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\api-flow.test.ts:158:42)\n    at Promise.then.completed (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"API Integration Flow State Machine and Governance Integration should transition state after proposal approval","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"should transition state after proposal approval"},{"ancestorTitles":["API Integration Flow","State Machine and Governance Integration"],"duration":8,"failureDetails":[{}],"failureMessages":["Error: Only PM can create proposals\n    at VoteService.createProposal (F:\\Hajimi Code Ultra\\lib\\core\\governance\\vote-service.ts:73:13)\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\api-flow.test.ts:178:25)\n    at Promise.then.completed (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"API Integration Flow State Machine and Governance Integration should track state history through transitions","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should track state history through transitions"},{"ancestorTitles":["API Integration Flow","State Machine and Governance Integration"],"duration":15,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Flow State Machine and Governance Integration should prevent unauthorized state transitions","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should prevent unauthorized state transitions"},{"ancestorTitles":["API Integration Flow","A2A and Governance Integration"],"duration":12,"failureDetails":[{}],"failureMessages":["Error: Only PM can create proposals\n    at VoteService.createProposal (F:\\Hajimi Code Ultra\\lib\\core\\governance\\vote-service.ts:73:13)\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\api-flow.test.ts:235:42)\n    at Promise.then.completed (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"API Integration Flow A2A and Governance Integration should send proposal notifications via A2A","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should send proposal notifications via A2A"},{"ancestorTitles":["API Integration Flow","A2A and Governance Integration"],"duration":8,"failureDetails":[{}],"failureMessages":["Error: Only PM can create proposals\n    at VoteService.createProposal (F:\\Hajimi Code Ultra\\lib\\core\\governance\\vote-service.ts:73:13)\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\api-flow.test.ts:255:42)\n    at Promise.then.completed (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"API Integration Flow A2A and Governance Integration should query proposal status through A2A","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should query proposal status through A2A"},{"ancestorTitles":["API Integration Flow","Auth and Authorization Integration"],"duration":8,"failureDetails":[{}],"failureMessages":["Error: Only PM can create proposals\n    at VoteService.createProposal (F:\\Hajimi Code Ultra\\lib\\core\\governance\\vote-service.ts:73:13)\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\api-flow.test.ts:300:42)\n    at Promise.then.completed (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"API Integration Flow Auth and Authorization Integration should enforce role-based access in full flow","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"failed","title":"should enforce role-based access in full flow"},{"ancestorTitles":["API Integration Flow","Auth and Authorization Integration"],"duration":11,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Flow Auth and Authorization Integration should handle token extraction from various sources","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should handle token extraction from various sources"},{"ancestorTitles":["API Integration Flow","Error Handling Integration"],"duration":26,"failureDetails":[{"matcherResult":{"message":"expect(received).rejects.toThrow(expected)\n\nExpected constructor: VoteServiceError\nReceived constructor: Error\n\nReceived message: \"Proposal not found: non-existent-id\"\n\n    \u001b[0m \u001b[90m 105 |\u001b[39m     \u001b[36mconst\u001b[39m proposal \u001b[33m=\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mproposals\u001b[33m.\u001b[39m\u001b[36mget\u001b[39m(proposalId)\u001b[33m;\u001b[39m\n     \u001b[90m 106 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mproposal) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 107 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`Proposal not found: ${proposalId}`\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 108 |\u001b[39m     }\n     \u001b[90m 109 |\u001b[39m\n     \u001b[90m 110 |\u001b[39m     \u001b[36mif\u001b[39m (proposal\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[32m'voting'\u001b[39m) {\u001b[0m\n\n      at VoteService.vote (lib/core/governance/vote-service.ts:107:13)\n      at Object.<anonymous> (tests/integration/api-flow.test.ts:349:21)","pass":false},"message":"expect(received).rejects.toThrow(expected)\n\nExpected constructor: VoteServiceError\nReceived constructor: Error\n\nReceived message: \"Proposal not found: non-existent-id\"\n\n    \u001b[0m \u001b[90m 105 |\u001b[39m     \u001b[36mconst\u001b[39m proposal \u001b[33m=\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mproposals\u001b[33m.\u001b[39m\u001b[36mget\u001b[39m(proposalId)\u001b[33m;\u001b[39m\n     \u001b[90m 106 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mproposal) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 107 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`Proposal not found: ${proposalId}`\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 108 |\u001b[39m     }\n     \u001b[90m 109 |\u001b[39m\n     \u001b[90m 110 |\u001b[39m     \u001b[36mif\u001b[39m (proposal\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[32m'voting'\u001b[39m) {\u001b[0m\n\n      at VoteService.vote (lib/core/governance/vote-service.ts:107:13)\n      at Object.<anonymous> (tests/integration/api-flow.test.ts:349:21)"}],"failureMessages":["Error: expect(received).rejects.toThrow(expected)\n\nExpected constructor: VoteServiceError\nReceived constructor: Error\n\nReceived message: \"Proposal not found: non-existent-id\"\n\n    \u001b[0m \u001b[90m 105 |\u001b[39m     \u001b[36mconst\u001b[39m proposal \u001b[33m=\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mproposals\u001b[33m.\u001b[39m\u001b[36mget\u001b[39m(proposalId)\u001b[33m;\u001b[39m\n     \u001b[90m 106 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mproposal) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 107 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`Proposal not found: ${proposalId}`\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 108 |\u001b[39m     }\n     \u001b[90m 109 |\u001b[39m\n     \u001b[90m 110 |\u001b[39m     \u001b[36mif\u001b[39m (proposal\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[32m'voting'\u001b[39m) {\u001b[0m\n\n      at VoteService.vote (lib/core/governance/vote-service.ts:107:13)\n      at Object.<anonymous> (tests/integration/api-flow.test.ts:349:21)\n    at Object.toThrow (F:\\Hajimi Code Ultra\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\api-flow.test.ts:350:17)\n    at Promise.then.completed (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"API Integration Flow Error Handling Integration should handle proposal not found error","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should handle proposal not found error"},{"ancestorTitles":["API Integration Flow","Error Handling Integration"],"duration":11,"failureDetails":[{}],"failureMessages":["Error: Only PM can create proposals\n    at VoteService.createProposal (F:\\Hajimi Code Ultra\\lib\\core\\governance\\vote-service.ts:73:13)\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\api-flow.test.ts:354:42)\n    at Promise.then.completed (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"API Integration Flow Error Handling Integration should handle duplicate vote error","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should handle duplicate vote error"},{"ancestorTitles":["API Integration Flow","Error Handling Integration"],"duration":8,"failureDetails":[{}],"failureMessages":["Error: Only PM can create proposals\n    at VoteService.createProposal (F:\\Hajimi Code Ultra\\lib\\core\\governance\\vote-service.ts:73:13)\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\api-flow.test.ts:370:42)\n    at Promise.then.completed (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"API Integration Flow Error Handling Integration should handle expired proposal","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should handle expired proposal"},{"ancestorTitles":["API Integration Flow","Error Handling Integration"],"duration":10,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Flow Error Handling Integration should handle invalid state transitions","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle invalid state transitions"},{"ancestorTitles":["API Integration Flow","Concurrent Operations"],"duration":7,"failureDetails":[{}],"failureMessages":["Error: Only PM can create proposals\n    at VoteService.createProposal (F:\\Hajimi Code Ultra\\lib\\core\\governance\\vote-service.ts:73:13)\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\api-flow.test.ts:400:42)\n    at Promise.then.completed (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"API Integration Flow Concurrent Operations should handle concurrent votes","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should handle concurrent votes"},{"ancestorTitles":["API Integration Flow","Concurrent Operations"],"duration":23,"failureDetails":[{"matcherResult":{"actual":1,"expected":5,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 5\nReceived: 1","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 5\nReceived: 1\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\api-flow.test.ts:437:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)"],"fullName":"API Integration Flow Concurrent Operations should handle concurrent message sending","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"failed","title":"should handle concurrent message sending"},{"ancestorTitles":["API Integration Flow","Performance Benchmarks"],"duration":8,"failureDetails":[{}],"failureMessages":["Error: Only PM can create proposals\n    at VoteService.createProposal (F:\\Hajimi Code Ultra\\lib\\core\\governance\\vote-service.ts:73:13)\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\api-flow.test.ts:449:27)\n    at Promise.then.completed (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"API Integration Flow Performance Benchmarks should create proposals within acceptable time","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should create proposals within acceptable time"},{"ancestorTitles":["API Integration Flow","Performance Benchmarks"],"duration":126,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Flow Performance Benchmarks should query history within acceptable time","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should query history within acceptable time"}],"endTime":1771053876344,"message":"  ● API Integration Flow ? End-to-End Workflow ? should complete full governance workflow with state transition\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: true\n    Received: undefined\n\n    \u001b[0m \u001b[90m 69 |\u001b[39m       })\u001b[33m;\u001b[39m\n     \u001b[90m 70 |\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 71 |\u001b[39m       expect(proposalResult\u001b[33m.\u001b[39msuccess)\u001b[33m.\u001b[39mtoBe(\u001b[36mtrue\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                                      \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 72 |\u001b[39m       \u001b[36mconst\u001b[39m proposalId \u001b[33m=\u001b[39m proposalResult\u001b[33m.\u001b[39mproposal\u001b[33m!\u001b[39m\u001b[33m.\u001b[39mid\u001b[33m;\u001b[39m\n     \u001b[90m 73 |\u001b[39m\n     \u001b[90m 74 |\u001b[39m       \u001b[90m// 2. 多个角色投票\u001b[39m\u001b[0m\n\n      at Object.<anonymous> (tests/integration/api-flow.test.ts:71:38)\n\n  ● API Integration Flow ? End-to-End Workflow ? should handle A2A communication during governance\n\n    Only PM can create proposals\n\n    \u001b[0m \u001b[90m 71 |\u001b[39m   \u001b[36masync\u001b[39m createProposal(request\u001b[33m:\u001b[39m \u001b[33mCreateProposalRequest\u001b[39m\u001b[33m,\u001b[39m proposer\u001b[33m:\u001b[39m \u001b[33mAgentRole\u001b[39m)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mProposal\u001b[39m\u001b[33m>\u001b[39m {\n     \u001b[90m 72 |\u001b[39m     \u001b[36mif\u001b[39m (proposer \u001b[33m!==\u001b[39m \u001b[32m'pm'\u001b[39m) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 73 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Only PM can create proposals'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 74 |\u001b[39m     }\n     \u001b[90m 75 |\u001b[39m\n     \u001b[90m 76 |\u001b[39m     \u001b[36mconst\u001b[39m now \u001b[33m=\u001b[39m \u001b[33mDate\u001b[39m\u001b[33m.\u001b[39mnow()\u001b[33m;\u001b[39m\u001b[0m\n\n      at VoteService.createProposal (lib/core/governance/vote-service.ts:73:13)\n      at Object.<anonymous> (tests/integration/api-flow.test.ts:92:42)\n\n  ● API Integration Flow ? State Machine and Governance Integration ? should transition state after proposal approval\n\n    Only PM can create proposals\n\n    \u001b[0m \u001b[90m 71 |\u001b[39m   \u001b[36masync\u001b[39m createProposal(request\u001b[33m:\u001b[39m \u001b[33mCreateProposalRequest\u001b[39m\u001b[33m,\u001b[39m proposer\u001b[33m:\u001b[39m \u001b[33mAgentRole\u001b[39m)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mProposal\u001b[39m\u001b[33m>\u001b[39m {\n     \u001b[90m 72 |\u001b[39m     \u001b[36mif\u001b[39m (proposer \u001b[33m!==\u001b[39m \u001b[32m'pm'\u001b[39m) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 73 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Only PM can create proposals'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 74 |\u001b[39m     }\n     \u001b[90m 75 |\u001b[39m\n     \u001b[90m 76 |\u001b[39m     \u001b[36mconst\u001b[39m now \u001b[33m=\u001b[39m \u001b[33mDate\u001b[39m\u001b[33m.\u001b[39mnow()\u001b[33m;\u001b[39m\u001b[0m\n\n      at VoteService.createProposal (lib/core/governance/vote-service.ts:73:13)\n      at Object.<anonymous> (tests/integration/api-flow.test.ts:158:42)\n\n  ● API Integration Flow ? State Machine and Governance Integration ? should track state history through transitions\n\n    Only PM can create proposals\n\n    \u001b[0m \u001b[90m 71 |\u001b[39m   \u001b[36masync\u001b[39m createProposal(request\u001b[33m:\u001b[39m \u001b[33mCreateProposalRequest\u001b[39m\u001b[33m,\u001b[39m proposer\u001b[33m:\u001b[39m \u001b[33mAgentRole\u001b[39m)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mProposal\u001b[39m\u001b[33m>\u001b[39m {\n     \u001b[90m 72 |\u001b[39m     \u001b[36mif\u001b[39m (proposer \u001b[33m!==\u001b[39m \u001b[32m'pm'\u001b[39m) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 73 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Only PM can create proposals'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 74 |\u001b[39m     }\n     \u001b[90m 75 |\u001b[39m\n     \u001b[90m 76 |\u001b[39m     \u001b[36mconst\u001b[39m now \u001b[33m=\u001b[39m \u001b[33mDate\u001b[39m\u001b[33m.\u001b[39mnow()\u001b[33m;\u001b[39m\u001b[0m\n\n      at VoteService.createProposal (lib/core/governance/vote-service.ts:73:13)\n      at Object.<anonymous> (tests/integration/api-flow.test.ts:178:25)\n\n  ● API Integration Flow ? A2A and Governance Integration ? should send proposal notifications via A2A\n\n    Only PM can create proposals\n\n    \u001b[0m \u001b[90m 71 |\u001b[39m   \u001b[36masync\u001b[39m createProposal(request\u001b[33m:\u001b[39m \u001b[33mCreateProposalRequest\u001b[39m\u001b[33m,\u001b[39m proposer\u001b[33m:\u001b[39m \u001b[33mAgentRole\u001b[39m)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mProposal\u001b[39m\u001b[33m>\u001b[39m {\n     \u001b[90m 72 |\u001b[39m     \u001b[36mif\u001b[39m (proposer \u001b[33m!==\u001b[39m \u001b[32m'pm'\u001b[39m) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 73 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Only PM can create proposals'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 74 |\u001b[39m     }\n     \u001b[90m 75 |\u001b[39m\n     \u001b[90m 76 |\u001b[39m     \u001b[36mconst\u001b[39m now \u001b[33m=\u001b[39m \u001b[33mDate\u001b[39m\u001b[33m.\u001b[39mnow()\u001b[33m;\u001b[39m\u001b[0m\n\n      at VoteService.createProposal (lib/core/governance/vote-service.ts:73:13)\n      at Object.<anonymous> (tests/integration/api-flow.test.ts:235:42)\n\n  ● API Integration Flow ? A2A and Governance Integration ? should query proposal status through A2A\n\n    Only PM can create proposals\n\n    \u001b[0m \u001b[90m 71 |\u001b[39m   \u001b[36masync\u001b[39m createProposal(request\u001b[33m:\u001b[39m \u001b[33mCreateProposalRequest\u001b[39m\u001b[33m,\u001b[39m proposer\u001b[33m:\u001b[39m \u001b[33mAgentRole\u001b[39m)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mProposal\u001b[39m\u001b[33m>\u001b[39m {\n     \u001b[90m 72 |\u001b[39m     \u001b[36mif\u001b[39m (proposer \u001b[33m!==\u001b[39m \u001b[32m'pm'\u001b[39m) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 73 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Only PM can create proposals'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 74 |\u001b[39m     }\n     \u001b[90m 75 |\u001b[39m\n     \u001b[90m 76 |\u001b[39m     \u001b[36mconst\u001b[39m now \u001b[33m=\u001b[39m \u001b[33mDate\u001b[39m\u001b[33m.\u001b[39mnow()\u001b[33m;\u001b[39m\u001b[0m\n\n      at VoteService.createProposal (lib/core/governance/vote-service.ts:73:13)\n      at Object.<anonymous> (tests/integration/api-flow.test.ts:255:42)\n\n  ● API Integration Flow ? Auth and Authorization Integration ? should enforce role-based access in full flow\n\n    Only PM can create proposals\n\n    \u001b[0m \u001b[90m 71 |\u001b[39m   \u001b[36masync\u001b[39m createProposal(request\u001b[33m:\u001b[39m \u001b[33mCreateProposalRequest\u001b[39m\u001b[33m,\u001b[39m proposer\u001b[33m:\u001b[39m \u001b[33mAgentRole\u001b[39m)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mProposal\u001b[39m\u001b[33m>\u001b[39m {\n     \u001b[90m 72 |\u001b[39m     \u001b[36mif\u001b[39m (proposer \u001b[33m!==\u001b[39m \u001b[32m'pm'\u001b[39m) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 73 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Only PM can create proposals'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 74 |\u001b[39m     }\n     \u001b[90m 75 |\u001b[39m\n     \u001b[90m 76 |\u001b[39m     \u001b[36mconst\u001b[39m now \u001b[33m=\u001b[39m \u001b[33mDate\u001b[39m\u001b[33m.\u001b[39mnow()\u001b[33m;\u001b[39m\u001b[0m\n\n      at VoteService.createProposal (lib/core/governance/vote-service.ts:73:13)\n      at Object.<anonymous> (tests/integration/api-flow.test.ts:300:42)\n\n  ● API Integration Flow ? Error Handling Integration ? should handle proposal not found error\n\n    expect(received).rejects.toThrow(expected)\n\n    Expected constructor: VoteServiceError\n    Received constructor: Error\n\n    Received message: \"Proposal not found: non-existent-id\"\n\n        \u001b[0m \u001b[90m 105 |\u001b[39m     \u001b[36mconst\u001b[39m proposal \u001b[33m=\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mproposals\u001b[33m.\u001b[39m\u001b[36mget\u001b[39m(proposalId)\u001b[33m;\u001b[39m\n         \u001b[90m 106 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mproposal) {\n        \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 107 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`Proposal not found: ${proposalId}`\u001b[39m)\u001b[33m;\u001b[39m\n         \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n         \u001b[90m 108 |\u001b[39m     }\n         \u001b[90m 109 |\u001b[39m\n         \u001b[90m 110 |\u001b[39m     \u001b[36mif\u001b[39m (proposal\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[32m'voting'\u001b[39m) {\u001b[0m\n\n      at VoteService.vote (lib/core/governance/vote-service.ts:107:13)\n      at Object.<anonymous> (tests/integration/api-flow.test.ts:349:21)\n      at Object.toThrow (node_modules/expect/build/index.js:218:22)\n      at Object.<anonymous> (tests/integration/api-flow.test.ts:350:17)\n\n  ● API Integration Flow ? Error Handling Integration ? should handle duplicate vote error\n\n    Only PM can create proposals\n\n    \u001b[0m \u001b[90m 71 |\u001b[39m   \u001b[36masync\u001b[39m createProposal(request\u001b[33m:\u001b[39m \u001b[33mCreateProposalRequest\u001b[39m\u001b[33m,\u001b[39m proposer\u001b[33m:\u001b[39m \u001b[33mAgentRole\u001b[39m)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mProposal\u001b[39m\u001b[33m>\u001b[39m {\n     \u001b[90m 72 |\u001b[39m     \u001b[36mif\u001b[39m (proposer \u001b[33m!==\u001b[39m \u001b[32m'pm'\u001b[39m) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 73 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Only PM can create proposals'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 74 |\u001b[39m     }\n     \u001b[90m 75 |\u001b[39m\n     \u001b[90m 76 |\u001b[39m     \u001b[36mconst\u001b[39m now \u001b[33m=\u001b[39m \u001b[33mDate\u001b[39m\u001b[33m.\u001b[39mnow()\u001b[33m;\u001b[39m\u001b[0m\n\n      at VoteService.createProposal (lib/core/governance/vote-service.ts:73:13)\n      at Object.<anonymous> (tests/integration/api-flow.test.ts:354:42)\n\n  ● API Integration Flow ? Error Handling Integration ? should handle expired proposal\n\n    Only PM can create proposals\n\n    \u001b[0m \u001b[90m 71 |\u001b[39m   \u001b[36masync\u001b[39m createProposal(request\u001b[33m:\u001b[39m \u001b[33mCreateProposalRequest\u001b[39m\u001b[33m,\u001b[39m proposer\u001b[33m:\u001b[39m \u001b[33mAgentRole\u001b[39m)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mProposal\u001b[39m\u001b[33m>\u001b[39m {\n     \u001b[90m 72 |\u001b[39m     \u001b[36mif\u001b[39m (proposer \u001b[33m!==\u001b[39m \u001b[32m'pm'\u001b[39m) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 73 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Only PM can create proposals'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 74 |\u001b[39m     }\n     \u001b[90m 75 |\u001b[39m\n     \u001b[90m 76 |\u001b[39m     \u001b[36mconst\u001b[39m now \u001b[33m=\u001b[39m \u001b[33mDate\u001b[39m\u001b[33m.\u001b[39mnow()\u001b[33m;\u001b[39m\u001b[0m\n\n      at VoteService.createProposal (lib/core/governance/vote-service.ts:73:13)\n      at Object.<anonymous> (tests/integration/api-flow.test.ts:370:42)\n\n  ● API Integration Flow ? Concurrent Operations ? should handle concurrent votes\n\n    Only PM can create proposals\n\n    \u001b[0m \u001b[90m 71 |\u001b[39m   \u001b[36masync\u001b[39m createProposal(request\u001b[33m:\u001b[39m \u001b[33mCreateProposalRequest\u001b[39m\u001b[33m,\u001b[39m proposer\u001b[33m:\u001b[39m \u001b[33mAgentRole\u001b[39m)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mProposal\u001b[39m\u001b[33m>\u001b[39m {\n     \u001b[90m 72 |\u001b[39m     \u001b[36mif\u001b[39m (proposer \u001b[33m!==\u001b[39m \u001b[32m'pm'\u001b[39m) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 73 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Only PM can create proposals'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 74 |\u001b[39m     }\n     \u001b[90m 75 |\u001b[39m\n     \u001b[90m 76 |\u001b[39m     \u001b[36mconst\u001b[39m now \u001b[33m=\u001b[39m \u001b[33mDate\u001b[39m\u001b[33m.\u001b[39mnow()\u001b[33m;\u001b[39m\u001b[0m\n\n      at VoteService.createProposal (lib/core/governance/vote-service.ts:73:13)\n      at Object.<anonymous> (tests/integration/api-flow.test.ts:400:42)\n\n  ● API Integration Flow ? Concurrent Operations ? should handle concurrent message sending\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 5\n    Received: 1\n\n    \u001b[0m \u001b[90m 435 |\u001b[39m       \u001b[90m// 验证历史\u001b[39m\n     \u001b[90m 436 |\u001b[39m       \u001b[36mconst\u001b[39m history \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m a2aService\u001b[33m.\u001b[39mgetHistory(sessionId)\u001b[33m;\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 437 |\u001b[39m       expect(history\u001b[33m.\u001b[39mpagination\u001b[33m.\u001b[39mtotal)\u001b[33m.\u001b[39mtoBe(\u001b[35m5\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                                        \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 438 |\u001b[39m     })\u001b[33m;\u001b[39m\n     \u001b[90m 439 |\u001b[39m   })\u001b[33m;\u001b[39m\n     \u001b[90m 440 |\u001b[39m\u001b[0m\n\n      at Object.<anonymous> (tests/integration/api-flow.test.ts:437:40)\n\n  ● API Integration Flow ? Performance Benchmarks ? should create proposals within acceptable time\n\n    Only PM can create proposals\n\n    \u001b[0m \u001b[90m 71 |\u001b[39m   \u001b[36masync\u001b[39m createProposal(request\u001b[33m:\u001b[39m \u001b[33mCreateProposalRequest\u001b[39m\u001b[33m,\u001b[39m proposer\u001b[33m:\u001b[39m \u001b[33mAgentRole\u001b[39m)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mProposal\u001b[39m\u001b[33m>\u001b[39m {\n     \u001b[90m 72 |\u001b[39m     \u001b[36mif\u001b[39m (proposer \u001b[33m!==\u001b[39m \u001b[32m'pm'\u001b[39m) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 73 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Only PM can create proposals'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 74 |\u001b[39m     }\n     \u001b[90m 75 |\u001b[39m\n     \u001b[90m 76 |\u001b[39m     \u001b[36mconst\u001b[39m now \u001b[33m=\u001b[39m \u001b[33mDate\u001b[39m\u001b[33m.\u001b[39mnow()\u001b[33m;\u001b[39m\u001b[0m\n\n      at VoteService.createProposal (lib/core/governance/vote-service.ts:73:13)\n      at Object.<anonymous> (tests/integration/api-flow.test.ts:449:27)\n","name":"F:\\Hajimi Code Ultra\\tests\\integration\\api-flow.test.ts","startTime":1771053870070,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["B-07 治理链路集成测试","TEST-010: 提案端点集成"],"duration":192,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 TEST-010: 提案端点集成 TEST-010-1: POST /api/v1/governance/proposals 创建提案成功","invocations":1,"location":null,"numPassingAsserts":10,"retryReasons":[],"status":"passed","title":"TEST-010-1: POST /api/v1/governance/proposals 创建提案成功"},{"ancestorTitles":["B-07 治理链路集成测试","TEST-010: 提案端点集成"],"duration":21,"failureDetails":[{"matcherResult":{"actual":3,"expected":2,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 2\nReceived: 3","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 2\nReceived: 3\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\governance-flow.test.ts:91:32)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)"],"fullName":"B-07 治理链路集成测试 TEST-010: 提案端点集成 TEST-010-2: GET /api/v1/governance/proposals 获取提案列表成功","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"failed","title":"TEST-010-2: GET /api/v1/governance/proposals 获取提案列表成功"},{"ancestorTitles":["B-07 治理链路集成测试","TEST-010: 提案端点集成"],"duration":340,"failureDetails":[{"matcherResult":{"actual":4,"expected":1,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 1\nReceived: 4","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 1\nReceived: 4\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\governance-flow.test.ts:121:38)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)"],"fullName":"B-07 治理链路集成测试 TEST-010: 提案端点集成 TEST-010-3: GET /api/v1/governance/proposals 支持按状态筛选","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"TEST-010-3: GET /api/v1/governance/proposals 支持按状态筛选"},{"ancestorTitles":["B-07 治理链路集成测试","TEST-010: 提案端点集成"],"duration":15,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 TEST-010: 提案端点集成 TEST-010-4: GET /api/v1/governance/proposals/:id 获取提案详情成功","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"TEST-010-4: GET /api/v1/governance/proposals/:id 获取提案详情成功"},{"ancestorTitles":["B-07 治理链路集成测试","TEST-010: 提案端点集成"],"duration":19,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 TEST-010: 提案端点集成 TEST-010-5: 验证响应格式符合API规范","invocations":1,"location":null,"numPassingAsserts":13,"retryReasons":[],"status":"passed","title":"TEST-010-5: 验证响应格式符合API规范"},{"ancestorTitles":["B-07 治理链路集成测试","TEST-010: 提案端点集成"],"duration":24,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 TEST-010: 提案端点集成 TEST-010-6: 非PM角色无法创建提案","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"TEST-010-6: 非PM角色无法创建提案"},{"ancestorTitles":["B-07 治理链路集成测试","TEST-011: 投票端点集成"],"duration":22,"failureDetails":[{}],"failureMessages":["Error: expect(received).toContain(expected) // indexOf\n\nMatcher error: received value must not be null nor undefined\n\nReceived has value: undefined\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\governance-flow.test.ts:201:33)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)"],"fullName":"B-07 治理链路集成测试 TEST-011: 投票端点集成 TEST-011-1: POST /api/v1/governance/vote 提交投票成功","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"failed","title":"TEST-011-1: POST /api/v1/governance/vote 提交投票成功"},{"ancestorTitles":["B-07 治理链路集成测试","TEST-011: 投票端点集成"],"duration":23,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 TEST-011: 投票端点集成 TEST-011-2: GET /api/v1/governance/vote?proposalId=xxx 获取投票统计成功","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"TEST-011-2: GET /api/v1/governance/vote?proposalId=xxx 获取投票统计成功"},{"ancestorTitles":["B-07 治理链路集成测试","TEST-011: 投票端点集成"],"duration":24,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 TEST-011: 投票端点集成 TEST-011-3: 验证权重计算正确","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"TEST-011-3: 验证权重计算正确"},{"ancestorTitles":["B-07 治理链路集成测试","TEST-011: 投票端点集成"],"duration":35,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 TEST-011: 投票端点集成 TEST-011-4: 验证多角色投票权重累加","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"TEST-011-4: 验证多角色投票权重累加"},{"ancestorTitles":["B-07 治理链路集成测试","TEST-011: 投票端点集成"],"duration":26,"failureDetails":[{}],"failureMessages":["Error: expect(received).toContain(expected) // indexOf\n\nMatcher error: received value must not be null nor undefined\n\nReceived has value: undefined\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\governance-flow.test.ts:255:33)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)"],"fullName":"B-07 治理链路集成测试 TEST-011: 投票端点集成 TEST-011-5: 验证无法重复投票（会覆盖）","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"TEST-011-5: 验证无法重复投票（会覆盖）"},{"ancestorTitles":["B-07 治理链路集成测试","TEST-011: 投票端点集成"],"duration":28,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 TEST-011: 投票端点集成 TEST-011-6: 验证弃权投票不计入通过权重","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"TEST-011-6: 验证弃权投票不计入通过权重"},{"ancestorTitles":["B-07 治理链路集成测试","TEST-011: 投票端点集成"],"duration":25,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 TEST-011: 投票端点集成 TEST-011-7: 不存在的提案投票会抛出错误","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"TEST-011-7: 不存在的提案投票会抛出错误"},{"ancestorTitles":["B-07 治理链路集成测试","TEST-012: 自动流转触发"],"duration":548,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 TEST-012: 自动流转触发 TEST-012-1: 模拟多角色投票达到60%阈值触发自动流转","invocations":1,"location":null,"numPassingAsserts":12,"retryReasons":[],"status":"passed","title":"TEST-012-1: 模拟多角色投票达到60%阈值触发自动流转"},{"ancestorTitles":["B-07 治理链路集成测试","TEST-012: 自动流转触发"],"duration":602,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 TEST-012: 自动流转触发 TEST-012-2: 验证提案状态自动变为 approved/executed","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"TEST-012-2: 验证提案状态自动变为 approved/executed"},{"ancestorTitles":["B-07 治理链路集成测试","TEST-012: 自动流转触发"],"duration":557,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 TEST-012: 自动流转触发 TEST-012-3: 验证自动触发状态流转","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"TEST-012-3: 验证自动触发状态流转"},{"ancestorTitles":["B-07 治理链路集成测试","TEST-012: 自动流转触发"],"duration":602,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 TEST-012: 自动流转触发 TEST-012-4: 验证状态机API返回新状态","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"TEST-012-4: 验证状态机API返回新状态"},{"ancestorTitles":["B-07 治理链路集成测试","TEST-012: 自动流转触发"],"duration":390,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 TEST-012: 自动流转触发 TEST-012-5: 未达60%阈值不会自动流转","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"TEST-012-5: 未达60%阈值不会自动流转"},{"ancestorTitles":["B-07 治理链路集成测试","TEST-012: 自动流转触发"],"duration":341,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 TEST-012: 自动流转触发 TEST-012-6: 拒绝率≥60%时自动拒绝提案","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"TEST-012-6: 拒绝率≥60%时自动拒绝提案"},{"ancestorTitles":["B-07 治理链路集成测试","完整闭环测试"],"duration":540,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 完整闭环测试 应完成 提案创建→投票→达到阈值→自动状态流转 完整闭环","invocations":1,"location":null,"numPassingAsserts":8,"retryReasons":[],"status":"passed","title":"应完成 提案创建→投票→达到阈值→自动状态流转 完整闭环"},{"ancestorTitles":["B-07 治理链路集成测试","完整闭环测试"],"duration":669,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 完整闭环测试 应支持多轮状态流转","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应支持多轮状态流转"},{"ancestorTitles":["B-07 治理链路集成测试","错误场景测试"],"duration":12,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 错误场景测试 应处理不存在的提案投票","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应处理不存在的提案投票"},{"ancestorTitles":["B-07 治理链路集成测试","错误场景测试"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 错误场景测试 应处理无效的状态流转请求","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应处理无效的状态流转请求"},{"ancestorTitles":["B-07 治理链路集成测试","权重边界测试"],"duration":19,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 权重边界测试 应正确处理刚好低于60%的情况","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应正确处理刚好低于60%的情况"},{"ancestorTitles":["B-07 治理链路集成测试","权重边界测试"],"duration":8,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 权重边界测试 应正确计算角色权重","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"应正确计算角色权重"},{"ancestorTitles":["B-07 治理链路集成测试","权重边界测试"],"duration":9,"failureDetails":[],"failureMessages":[],"fullName":"B-07 治理链路集成测试 权重边界测试 应正确验证投票规则常量","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应正确验证投票规则常量"}],"endTime":1771053876998,"message":"  ● B-07 治理链路集成测试 ? TEST-010: 提案端点集成 ? TEST-010-2: GET /api/v1/governance/proposals 获取提案列表成功\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 2\n    Received: 3\n\n    \u001b[0m \u001b[90m 89 |\u001b[39m       expect(proposals)\u001b[33m.\u001b[39mtoBeDefined()\u001b[33m;\u001b[39m\n     \u001b[90m 90 |\u001b[39m       expect(\u001b[33mArray\u001b[39m\u001b[33m.\u001b[39misArray(proposals))\u001b[33m.\u001b[39mtoBe(\u001b[36mtrue\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 91 |\u001b[39m       expect(proposals\u001b[33m.\u001b[39mlength)\u001b[33m.\u001b[39mtoBe(\u001b[35m2\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                                \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 92 |\u001b[39m     })\u001b[33m;\u001b[39m\n     \u001b[90m 93 |\u001b[39m\n     \u001b[90m 94 |\u001b[39m     it(\u001b[32m'TEST-010-3: GET /api/v1/governance/proposals 支持按状态筛选'\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\n\n      at Object.<anonymous> (tests/integration/governance-flow.test.ts:91:32)\n\n  ● B-07 治理链路集成测试 ? TEST-010: 提案端点集成 ? TEST-010-3: GET /api/v1/governance/proposals 支持按状态筛选\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 1\n    Received: 4\n\n    \u001b[0m \u001b[90m 119 |\u001b[39m       \u001b[90m// 获取active（voting状态）提案\u001b[39m\n     \u001b[90m 120 |\u001b[39m       \u001b[36mconst\u001b[39m activeProposals \u001b[33m=\u001b[39m voteService\u001b[33m.\u001b[39mgetActiveProposals()\u001b[33m;\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 121 |\u001b[39m       expect(activeProposals\u001b[33m.\u001b[39mlength)\u001b[33m.\u001b[39mtoBe(\u001b[35m1\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                                      \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 122 |\u001b[39m       expect(activeProposals[\u001b[35m0\u001b[39m]\u001b[33m.\u001b[39mtitle)\u001b[33m.\u001b[39mtoBe(\u001b[32m'待筛选提案2'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m 123 |\u001b[39m     })\u001b[33m;\u001b[39m\n     \u001b[90m 124 |\u001b[39m\u001b[0m\n\n      at Object.<anonymous> (tests/integration/governance-flow.test.ts:121:38)\n\n  ● B-07 治理链路集成测试 ? TEST-011: 投票端点集成 ? TEST-011-1: POST /api/v1/governance/vote 提交投票成功\n\n    expect(received).toContain(expected) // indexOf\n\n    Matcher error: received value must not be null nor undefined\n\n    Received has value: undefined\n\n    \u001b[0m \u001b[90m 199 |\u001b[39m       expect(result\u001b[33m.\u001b[39mproposalId)\u001b[33m.\u001b[39mtoBe(testProposalId)\u001b[33m;\u001b[39m\n     \u001b[90m 200 |\u001b[39m       expect(result\u001b[33m.\u001b[39mtotalVotes)\u001b[33m.\u001b[39mtoBe(\u001b[35m1\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 201 |\u001b[39m       expect(result\u001b[33m.\u001b[39mvotedRoles)\u001b[33m.\u001b[39mtoContain(\u001b[32m'pm'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                                 \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 202 |\u001b[39m     })\u001b[33m;\u001b[39m\n     \u001b[90m 203 |\u001b[39m\n     \u001b[90m 204 |\u001b[39m     it(\u001b[32m'TEST-011-2: GET /api/v1/governance/vote?proposalId=xxx 获取投票统计成功'\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\n\n      at Object.<anonymous> (tests/integration/governance-flow.test.ts:201:33)\n\n  ● B-07 治理链路集成测试 ? TEST-011: 投票端点集成 ? TEST-011-5: 验证无法重复投票（会覆盖）\n\n    expect(received).toContain(expected) // indexOf\n\n    Matcher error: received value must not be null nor undefined\n\n    Received has value: undefined\n\n    \u001b[0m \u001b[90m 253 |\u001b[39m\n     \u001b[90m 254 |\u001b[39m       expect(result\u001b[33m.\u001b[39mtotalVotes)\u001b[33m.\u001b[39mtoBe(\u001b[35m1\u001b[39m)\u001b[33m;\u001b[39m \u001b[90m// 仍然只有1票\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 255 |\u001b[39m       expect(result\u001b[33m.\u001b[39mvotedRoles)\u001b[33m.\u001b[39mtoContain(\u001b[32m'pm'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                                 \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 256 |\u001b[39m       \n     \u001b[90m 257 |\u001b[39m       \u001b[90m// 验证只有一票且为reject\u001b[39m\n     \u001b[90m 258 |\u001b[39m       \u001b[36mconst\u001b[39m stats \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m voteService\u001b[33m.\u001b[39mgetVoteStats(testProposalId)\u001b[33m;\u001b[39m\u001b[0m\n\n      at Object.<anonymous> (tests/integration/governance-flow.test.ts:255:33)\n","name":"F:\\Hajimi Code Ultra\\tests\\integration\\governance-flow.test.ts","startTime":1771053870077,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["Governance","GOV-001: PM创建提案"],"duration":4058,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-001: PM创建提案 TEST-001-01: PM角色可以成功创建提案","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"TEST-001-01: PM角色可以成功创建提案"},{"ancestorTitles":["Governance","GOV-001: PM创建提案"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-001: PM创建提案 TEST-001-02: 验证提案字段完整性（id, title, description, targetState, status等）","invocations":1,"location":null,"numPassingAsserts":11,"retryReasons":[],"status":"passed","title":"TEST-001-02: 验证提案字段完整性（id, title, description, targetState, status等）"},{"ancestorTitles":["Governance","GOV-001: PM创建提案"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-001: PM创建提案 TEST-001-03: 验证默认状态为voting","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-001-03: 验证默认状态为voting"},{"ancestorTitles":["Governance","GOV-001: PM创建提案"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-001: PM创建提案 TEST-001-04: 验证过期时间正确设置（30分钟）","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"TEST-001-04: 验证过期时间正确设置（30分钟）"},{"ancestorTitles":["Governance","GOV-001: PM创建提案"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-001: PM创建提案 TEST-001-05: 生成唯一提案ID","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"TEST-001-05: 生成唯一提案ID"},{"ancestorTitles":["Governance","GOV-002: 非PM创建被拒"],"duration":37,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-002: 非PM创建被拒 TEST-002-01: arch角色创建提案应该被拒绝","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-002-01: arch角色创建提案应该被拒绝"},{"ancestorTitles":["Governance","GOV-002: 非PM创建被拒"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-002: 非PM创建被拒 TEST-002-02: engineer角色创建提案应该被拒绝","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"TEST-002-02: engineer角色创建提案应该被拒绝"},{"ancestorTitles":["Governance","GOV-002: 非PM创建被拒"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-002: 非PM创建被拒 TEST-002-03: qa角色创建提案应该被拒绝","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"TEST-002-03: qa角色创建提案应该被拒绝"},{"ancestorTitles":["Governance","GOV-002: 非PM创建被拒"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-002: 非PM创建被拒 TEST-002-04: 验证返回正确的错误码和状态码","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"TEST-002-04: 验证返回正确的错误码和状态码"},{"ancestorTitles":["Governance","GOV-002: 非PM创建被拒"],"duration":10,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-002: 非PM创建被拒 TEST-002-05: VoteService同样拒绝非PM创建提案","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-002-05: VoteService同样拒绝非PM创建提案"},{"ancestorTitles":["Governance","GOV-003: 列表倒序排列"],"duration":190,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-003: 列表倒序排列 TEST-003-01: 创建多个提案，验证返回列表按createdAt降序排列","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"TEST-003-01: 创建多个提案，验证返回列表按createdAt降序排列"},{"ancestorTitles":["Governance","GOV-003: 列表倒序排列"],"duration":61,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-003: 列表倒序排列 TEST-003-02: 验证最新创建的提案在列表首位","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-003-02: 验证最新创建的提案在列表首位"},{"ancestorTitles":["Governance","GOV-003: 列表倒序排列"],"duration":61,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-003: 列表倒序排列 TEST-003-03: VoteService返回的提案列表也应倒序排列","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"TEST-003-03: VoteService返回的提案列表也应倒序排列"},{"ancestorTitles":["Governance","GOV-004: 30分钟过期"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-004: 30分钟过期 TEST-004-01: 验证默认过期时间为30分钟","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"TEST-004-01: 验证默认过期时间为30分钟"},{"ancestorTitles":["Governance","GOV-004: 30分钟过期"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-004: 30分钟过期 TEST-004-02: 允许自定义超时时间","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"TEST-004-02: 允许自定义超时时间"},{"ancestorTitles":["Governance","GOV-004: 30分钟过期"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-004: 30分钟过期 TEST-004-03: VoteService创建的提案默认30分钟过期","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"TEST-004-03: VoteService创建的提案默认30分钟过期"},{"ancestorTitles":["Governance","GOV-004: 30分钟过期"],"duration":215,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-004: 30分钟过期 TEST-004-04: 过期检查定时器正常工作","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"TEST-004-04: 过期检查定时器正常工作"},{"ancestorTitles":["Governance","GOV-005: 投票提交统计"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-005: 投票提交统计 TEST-002: 验证投票权重计算正确（pm/arch权重2，其他权重1）","invocations":1,"location":null,"numPassingAsserts":7,"retryReasons":[],"status":"passed","title":"TEST-002: 验证投票权重计算正确（pm/arch权重2，其他权重1）"},{"ancestorTitles":["Governance","GOV-005: 投票提交统计"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-005: 投票提交统计 TEST-005-01: 验证总票数、各选项票数统计正确","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"TEST-005-01: 验证总票数、各选项票数统计正确"},{"ancestorTitles":["Governance","GOV-005: 投票提交统计"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-005: 投票提交统计 TEST-005-02: 验证无法重复投票（同一角色再次投票应更新而非新增）","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"TEST-005-02: 验证无法重复投票（同一角色再次投票应更新而非新增）"},{"ancestorTitles":["Governance","GOV-005: 投票提交统计"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-005: 投票提交统计 TEST-005-03: 验证非投票角色无法投票","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"TEST-005-03: 验证非投票角色无法投票"},{"ancestorTitles":["Governance","GOV-005: 投票提交统计"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-005: 投票提交统计 TEST-005-04: ProposalService.castVote更新提案投票","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"TEST-005-04: ProposalService.castVote更新提案投票"},{"ancestorTitles":["Governance","GOV-006: 60%阈值自动执行"],"duration":103,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-006: 60%阈值自动执行 TEST-003: 模拟投票使通过率达到60%，验证提案状态变为approved","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"TEST-003: 模拟投票使通过率达到60%，验证提案状态变为approved"},{"ancestorTitles":["Governance","GOV-006: 60%阈值自动执行"],"duration":108,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-006: 60%阈值自动执行 TEST-006-01: 验证自动触发状态流转","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"TEST-006-01: 验证自动触发状态流转"},{"ancestorTitles":["Governance","GOV-006: 60%阈值自动执行"],"duration":109,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-006: 60%阈值自动执行 TEST-006-02: 验证状态机接收到正确的targetState","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"TEST-006-02: 验证状态机接收到正确的targetState"},{"ancestorTitles":["Governance","GOV-006: 60%阈值自动执行"],"duration":109,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-006: 60%阈值自动执行 TEST-006-03: 未达到阈值时不应自动执行","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-006-03: 未达到阈值时不应自动执行"},{"ancestorTitles":["Governance","GOV-006: 60%阈值自动执行"],"duration":107,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-006: 60%阈值自动执行 TEST-006-04: 高反对率时应自动拒绝","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"TEST-006-04: 高反对率时应自动拒绝"},{"ancestorTitles":["Governance","GOV-006: 60%阈值自动执行"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Governance GOV-006: 60%阈值自动执行 TEST-006-05: 验证批准阈值常量VOTING_RULES.APPROVAL_THRESHOLD为0.6","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"TEST-006-05: 验证批准阈值常量VOTING_RULES.APPROVAL_THRESHOLD为0.6"},{"ancestorTitles":["Governance","边界条件测试"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Governance 边界条件测试 应该验证提案标题不能为空","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该验证提案标题不能为空"},{"ancestorTitles":["Governance","边界条件测试"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Governance 边界条件测试 应该验证提案描述不能为空","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该验证提案描述不能为空"},{"ancestorTitles":["Governance","边界条件测试"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Governance 边界条件测试 应该验证目标状态不能为空","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该验证目标状态不能为空"},{"ancestorTitles":["Governance","边界条件测试"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Governance 边界条件测试 不能对不存在的提案投票","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"不能对不存在的提案投票"},{"ancestorTitles":["Governance","边界条件测试"],"duration":103,"failureDetails":[],"failureMessages":[],"fullName":"Governance 边界条件测试 不能对已执行的提案投票","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"不能对已执行的提案投票"}],"endTime":1771053877141,"message":"","name":"F:\\Hajimi Code Ultra\\tests\\unit\\governance.test.ts","startTime":1771053870060,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["E2E Full Lifecycle Workflow Tests","E2E-001: Happy Path Full Workflow"],"duration":4081,"failureDetails":[{"matcherResult":{"actual":"DESIGN","expected":"IDLE","message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: \"IDLE\"\nReceived: \"DESIGN\"","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: \"IDLE\"\nReceived: \"DESIGN\"\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\full-lifecycle.test.ts:48:28)\n    at Promise.then.completed (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"E2E Full Lifecycle Workflow Tests E2E-001: Happy Path Full Workflow E2E-001-01: 应完成完整的七权流转 IDLE→DESIGN→CODE→AUDIT→BUILD→DEPLOY→DONE","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"E2E-001-01: 应完成完整的七权流转 IDLE→DESIGN→CODE→AUDIT→BUILD→DEPLOY→DONE"},{"ancestorTitles":["E2E Full Lifecycle Workflow Tests","E2E-001: Happy Path Full Workflow"],"duration":1001,"failureDetails":[{"matcherResult":{"actual":5,"expected":4,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 4\nReceived: 5","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 4\nReceived: 5\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\tests\\integration\\full-lifecycle.test.ts:219:30)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)"],"fullName":"E2E Full Lifecycle Workflow Tests E2E-001: Happy Path Full Workflow E2E-001-02: 应允许中间状态跳转回退（DESIGN→IDLE, CODE→DESIGN）","invocations":1,"location":null,"numPassingAsserts":7,"retryReasons":[],"status":"failed","title":"E2E-001-02: 应允许中间状态跳转回退（DESIGN→IDLE, CODE→DESIGN）"},{"ancestorTitles":["E2E Full Lifecycle Workflow Tests","E2E-002: Invalid Transition Blocking"],"duration":9,"failureDetails":[],"failureMessages":[],"fullName":"E2E Full Lifecycle Workflow Tests E2E-002: Invalid Transition Blocking E2E-002-01: 应拒绝从IDLE直接到DEPLOY的非法流转","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"E2E-002-01: 应拒绝从IDLE直接到DEPLOY的非法流转"},{"ancestorTitles":["E2E Full Lifecycle Workflow Tests","E2E-002: Invalid Transition Blocking"],"duration":14,"failureDetails":[],"failureMessages":[],"fullName":"E2E Full Lifecycle Workflow Tests E2E-002: Invalid Transition Blocking E2E-002-02: 应拒绝从CODE直接到DONE的非法流转","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"E2E-002-02: 应拒绝从CODE直接到DONE的非法流转"},{"ancestorTitles":["E2E Full Lifecycle Workflow Tests","E2E-002: Invalid Transition Blocking"],"duration":19,"failureDetails":[],"failureMessages":[],"fullName":"E2E Full Lifecycle Workflow Tests E2E-002: Invalid Transition Blocking E2E-002-03: 应拒绝非授权角色的流转尝试","invocations":1,"location":null,"numPassingAsserts":11,"retryReasons":[],"status":"passed","title":"E2E-002-03: 应拒绝非授权角色的流转尝试"},{"ancestorTitles":["E2E Full Lifecycle Workflow Tests","E2E-002: Invalid Transition Blocking"],"duration":31,"failureDetails":[],"failureMessages":[],"fullName":"E2E Full Lifecycle Workflow Tests E2E-002: Invalid Transition Blocking E2E-002-04: 应拒绝从DONE状态继续流转","invocations":1,"location":null,"numPassingAsserts":12,"retryReasons":[],"status":"passed","title":"E2E-002-04: 应拒绝从DONE状态继续流转"},{"ancestorTitles":["E2E Full Lifecycle Workflow Tests","E2E-002: Invalid Transition Blocking"],"duration":320,"failureDetails":[],"failureMessages":[],"fullName":"E2E Full Lifecycle Workflow Tests E2E-002: Invalid Transition Blocking E2E-002-05: 应拒绝投票未达到阈值的提案","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"E2E-002-05: 应拒绝投票未达到阈值的提案"},{"ancestorTitles":["E2E Full Lifecycle Workflow Tests","E2E-003: Concurrent Proposal Conflicts"],"duration":14,"failureDetails":[],"failureMessages":[],"fullName":"E2E Full Lifecycle Workflow Tests E2E-003: Concurrent Proposal Conflicts E2E-003-01: 应正确处理同时创建的多个提案","invocations":1,"location":null,"numPassingAsserts":9,"retryReasons":[],"status":"passed","title":"E2E-003-01: 应正确处理同时创建的多个提案"},{"ancestorTitles":["E2E Full Lifecycle Workflow Tests","E2E-003: Concurrent Proposal Conflicts"],"duration":341,"failureDetails":[],"failureMessages":[],"fullName":"E2E Full Lifecycle Workflow Tests E2E-003: Concurrent Proposal Conflicts E2E-003-02: 应验证对不同提案的投票互不干扰","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"E2E-003-02: 应验证对不同提案的投票互不干扰"},{"ancestorTitles":["E2E Full Lifecycle Workflow Tests","E2E-003: Concurrent Proposal Conflicts"],"duration":327,"failureDetails":[],"failureMessages":[],"fullName":"E2E Full Lifecycle Workflow Tests E2E-003: Concurrent Proposal Conflicts E2E-003-03: 应验证并发投票的正确性","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"E2E-003-03: 应验证并发投票的正确性"},{"ancestorTitles":["E2E Full Lifecycle Workflow Tests","E2E-003: Concurrent Proposal Conflicts"],"duration":341,"failureDetails":[],"failureMessages":[],"fullName":"E2E Full Lifecycle Workflow Tests E2E-003: Concurrent Proposal Conflicts E2E-003-04: 应正确处理一个通过后另一个仍在投票的状态","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"E2E-003-04: 应正确处理一个通过后另一个仍在投票的状态"},{"ancestorTitles":["E2E Full Lifecycle Workflow Tests","Complete Workflow Validation"],"duration":708,"failureDetails":[],"failureMessages":[],"fullName":"E2E Full Lifecycle Workflow Tests Complete Workflow Validation 应验证完整工作流中的状态历史记录准确性","invocations":1,"location":null,"numPassingAsserts":22,"retryReasons":[],"status":"passed","title":"应验证完整工作流中的状态历史记录准确性"},{"ancestorTitles":["E2E Full Lifecycle Workflow Tests","Complete Workflow Validation"],"duration":68,"failureDetails":[],"failureMessages":[],"fullName":"E2E Full Lifecycle Workflow Tests Complete Workflow Validation 应验证不同角色权限在完整工作流中的正确性","invocations":1,"location":null,"numPassingAsserts":32,"retryReasons":[],"status":"passed","title":"应验证不同角色权限在完整工作流中的正确性"}],"endTime":1771053879169,"message":"  ● E2E Full Lifecycle Workflow Tests ? E2E-001: Happy Path Full Workflow ? E2E-001-01: 应完成完整的七权流转 IDLE→DESIGN→CODE→AUDIT→BUILD→DEPLOY→DONE\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: \"IDLE\"\n    Received: \"DESIGN\"\n\n    \u001b[0m \u001b[90m 46 |\u001b[39m       \u001b[90m// 1. 验证系统初始状态为 IDLE\u001b[39m\n     \u001b[90m 47 |\u001b[39m       \u001b[36mconst\u001b[39m initialState \u001b[33m=\u001b[39m stateMachine\u001b[33m.\u001b[39mgetCurrentState()\u001b[33m;\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 48 |\u001b[39m       expect(initialState)\u001b[33m.\u001b[39mtoBe(\u001b[32m'IDLE'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                            \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 49 |\u001b[39m\n     \u001b[90m 50 |\u001b[39m       \u001b[90m// 2. IDLE → DESIGN (PM提案, 投票通过)\u001b[39m\n     \u001b[90m 51 |\u001b[39m       \u001b[36mconst\u001b[39m proposal1 \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m voteService\u001b[33m.\u001b[39mcreateProposal({\u001b[0m\n\n      at Object.<anonymous> (tests/integration/full-lifecycle.test.ts:48:28)\n\n  ● E2E Full Lifecycle Workflow Tests ? E2E-001: Happy Path Full Workflow ? E2E-001-02: 应允许中间状态跳转回退（DESIGN→IDLE, CODE→DESIGN）\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 4\n    Received: 5\n\n    \u001b[0m \u001b[90m 217 |\u001b[39m       \u001b[90m// 验证历史记录包含回退\u001b[39m\n     \u001b[90m 218 |\u001b[39m       \u001b[36mconst\u001b[39m history \u001b[33m=\u001b[39m stateMachine\u001b[33m.\u001b[39mgetHistory()\u001b[33m;\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 219 |\u001b[39m       expect(history\u001b[33m.\u001b[39mlength)\u001b[33m.\u001b[39mtoBe(\u001b[35m4\u001b[39m)\u001b[33m;\u001b[39m \u001b[90m// DESIGN→IDLE→DESIGN→CODE→DESIGN\u001b[39m\n     \u001b[90m     |\u001b[39m                              \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 220 |\u001b[39m       expect(history[\u001b[35m0\u001b[39m]\u001b[33m.\u001b[39mto)\u001b[33m.\u001b[39mtoBe(\u001b[32m'DESIGN'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m 221 |\u001b[39m       expect(history[\u001b[35m1\u001b[39m]\u001b[33m.\u001b[39mto)\u001b[33m.\u001b[39mtoBe(\u001b[32m'IDLE'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m 222 |\u001b[39m       expect(history[\u001b[35m2\u001b[39m]\u001b[33m.\u001b[39mto)\u001b[33m.\u001b[39mtoBe(\u001b[32m'DESIGN'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      at Object.<anonymous> (tests/integration/full-lifecycle.test.ts:219:30)\n","name":"F:\\Hajimi Code Ultra\\tests\\integration\\full-lifecycle.test.ts","startTime":1771053870078,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["RedisStore","[TSA-001] Redis连接建立"],"duration":18,"failureDetails":[],"failureMessages":[],"fullName":"RedisStore [TSA-001] Redis连接建立 应该成功连接到Redis","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功连接到Redis"},{"ancestorTitles":["RedisStore","[TSA-001] Redis连接建立"],"duration":5001,"failureDetails":[{"message":"thrown: \"Exceeded timeout of 5000 ms for a test.\nAdd a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout.\""}],"failureMessages":["Error: thrown: \"Exceeded timeout of 5000 ms for a test.\nAdd a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout.\"\n    at F:\\Hajimi Code Ultra\\lib\\tsa\\tests\\RedisStore.test.ts:45:5\n    at _dispatchDescribe (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\index.js:91:26)\n    at describe (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\index.js:55:5)\n    at F:\\Hajimi Code Ultra\\lib\\tsa\\tests\\RedisStore.test.ts:31:3\n    at _dispatchDescribe (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\index.js:91:26)\n    at describe (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\index.js:55:5)\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\lib\\tsa\\tests\\RedisStore.test.ts:15:1)\n    at Runtime._execModule (F:\\Hajimi Code Ultra\\node_modules\\jest-runtime\\build\\index.js:1439:24)\n    at Runtime._loadModule (F:\\Hajimi Code Ultra\\node_modules\\jest-runtime\\build\\index.js:1022:12)\n    at Runtime.requireModule (F:\\Hajimi Code Ultra\\node_modules\\jest-runtime\\build\\index.js:882:12)\n    at jestAdapter (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:77:13)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at runTestInternal (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"RedisStore [TSA-001] Redis连接建立 连接失败时应切换到内存降级","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"连接失败时应切换到内存降级"},{"ancestorTitles":["RedisStore","[TSA-001] Redis连接建立"],"duration":5014,"failureDetails":[{"message":"thrown: \"Exceeded timeout of 5000 ms for a test.\nAdd a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout.\""}],"failureMessages":["Error: thrown: \"Exceeded timeout of 5000 ms for a test.\nAdd a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout.\"\n    at F:\\Hajimi Code Ultra\\lib\\tsa\\tests\\RedisStore.test.ts:54:5\n    at _dispatchDescribe (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\index.js:91:26)\n    at describe (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\index.js:55:5)\n    at F:\\Hajimi Code Ultra\\lib\\tsa\\tests\\RedisStore.test.ts:31:3\n    at _dispatchDescribe (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\index.js:91:26)\n    at describe (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\index.js:55:5)\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\lib\\tsa\\tests\\RedisStore.test.ts:15:1)\n    at Runtime._execModule (F:\\Hajimi Code Ultra\\node_modules\\jest-runtime\\build\\index.js:1439:24)\n    at Runtime._loadModule (F:\\Hajimi Code Ultra\\node_modules\\jest-runtime\\build\\index.js:1022:12)\n    at Runtime.requireModule (F:\\Hajimi Code Ultra\\node_modules\\jest-runtime\\build\\index.js:882:12)\n    at jestAdapter (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:77:13)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at runTestInternal (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"RedisStore [TSA-001] Redis连接建立 超时情况下应切换到内存降级","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"超时情况下应切换到内存降级"},{"ancestorTitles":["RedisStore","[TSA-002] 数据持久化"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"RedisStore [TSA-002] 数据持久化 应该能存储和读取数据","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该能存储和读取数据"},{"ancestorTitles":["RedisStore","[TSA-002] 数据持久化"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"RedisStore [TSA-002] 数据持久化 不存在的键应返回null","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"不存在的键应返回null"},{"ancestorTitles":["RedisStore","[TSA-002] 数据持久化"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"RedisStore [TSA-002] 数据持久化 应该能删除数据","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该能删除数据"},{"ancestorTitles":["RedisStore","[TSA-002] 数据持久化"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"RedisStore [TSA-002] 数据持久化 应该能清空所有数据","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该能清空所有数据"},{"ancestorTitles":["RedisStore","[TSA-003] TTL过期清理"],"duration":165,"failureDetails":[],"failureMessages":[],"fullName":"RedisStore [TSA-003] TTL过期清理 应该支持TTL设置","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该支持TTL设置"},{"ancestorTitles":["RedisStore","[TSA-003] TTL过期清理"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"RedisStore [TSA-003] TTL过期清理 应该正确计算剩余TTL","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该正确计算剩余TTL"},{"ancestorTitles":["RedisStore","降级模式"],"duration":111,"failureDetails":[{"matcherResult":{"actual":false,"expected":true,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: true\nReceived: false","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: true\nReceived: false\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\lib\\tsa\\tests\\RedisStore.test.ts:196:47)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)"],"fullName":"RedisStore 降级模式 无配置时应自动使用内存存储","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"无配置时应自动使用内存存储"},{"ancestorTitles":["RedisStore","降级模式"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"RedisStore 降级模式 手动强制降级","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"手动强制降级"},{"ancestorTitles":["RedisStore","降级模式"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"RedisStore 降级模式 重试连接","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"重试连接"},{"ancestorTitles":["RedisStore","批量操作"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"RedisStore 批量操作 应该支持批量获取","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该支持批量获取"},{"ancestorTitles":["RedisStore","批量操作"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"RedisStore 批量操作 应该支持批量设置","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该支持批量设置"},{"ancestorTitles":["RedisStore","批量操作"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"RedisStore 批量操作 应该支持批量删除","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该支持批量删除"},{"ancestorTitles":["RedisStore","统计信息"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"RedisStore 统计信息 应该返回正确的统计信息","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该返回正确的统计信息"},{"ancestorTitles":["RedisStore","统计信息"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"RedisStore 统计信息 应该正确统计各层数据量","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该正确统计各层数据量"},{"ancestorTitles":["RedisStore","错误处理"],"duration":5009,"failureDetails":[{"message":"thrown: \"Exceeded timeout of 5000 ms for a test.\nAdd a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout.\""}],"failureMessages":["Error: thrown: \"Exceeded timeout of 5000 ms for a test.\nAdd a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout.\"\n    at F:\\Hajimi Code Ultra\\lib\\tsa\\tests\\RedisStore.test.ts:300:5\n    at _dispatchDescribe (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\index.js:91:26)\n    at describe (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\index.js:55:5)\n    at F:\\Hajimi Code Ultra\\lib\\tsa\\tests\\RedisStore.test.ts:299:3\n    at _dispatchDescribe (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\index.js:91:26)\n    at describe (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\index.js:55:5)\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\lib\\tsa\\tests\\RedisStore.test.ts:15:1)\n    at Runtime._execModule (F:\\Hajimi Code Ultra\\node_modules\\jest-runtime\\build\\index.js:1439:24)\n    at Runtime._loadModule (F:\\Hajimi Code Ultra\\node_modules\\jest-runtime\\build\\index.js:1022:12)\n    at Runtime.requireModule (F:\\Hajimi Code Ultra\\node_modules\\jest-runtime\\build\\index.js:882:12)\n    at jestAdapter (F:\\Hajimi Code Ultra\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:77:13)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at runTestInternal (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (F:\\Hajimi Code Ultra\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"RedisStore 错误处理 应该处理网络错误并切换到降级","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该处理网络错误并切换到降级"},{"ancestorTitles":["RedisStore","错误处理"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"RedisStore 错误处理 应该处理JSON解析错误","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该处理JSON解析错误"},{"ancestorTitles":["TSA Integration"],"duration":145,"failureDetails":[{}],"failureMessages":["TypeError: TSA.getStatus is not a function\n    at Object.<anonymous> (F:\\Hajimi Code Ultra\\lib\\tsa\\tests\\RedisStore.test.ts:346:30)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)"],"fullName":"TSA Integration 应该初始化并报告状态","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该初始化并报告状态"},{"ancestorTitles":["TSA Integration"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"TSA Integration 应该支持数据读写","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该支持数据读写"},{"ancestorTitles":["TSA Integration"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"TSA Integration 应该支持存储层配置","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该支持存储层配置"}],"endTime":1771053887309,"message":"  ● RedisStore ? [TSA-001] Redis连接建立 ? 连接失败时应切换到内存降级\n\n    thrown: \"Exceeded timeout of 5000 ms for a test.\n    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout.\"\n\n    \u001b[0m \u001b[90m 43 |\u001b[39m     })\u001b[33m;\u001b[39m\n     \u001b[90m 44 |\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 45 |\u001b[39m     it(\u001b[32m'连接失败时应切换到内存降级'\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\n     \u001b[90m    |\u001b[39m     \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 46 |\u001b[39m       (fetch \u001b[36mas\u001b[39m jest\u001b[33m.\u001b[39m\u001b[33mMock\u001b[39m)\u001b[33m.\u001b[39mmockRejectedValueOnce(\u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Connection refused'\u001b[39m))\u001b[33m;\u001b[39m\n     \u001b[90m 47 |\u001b[39m\n     \u001b[90m 48 |\u001b[39m       \u001b[36mconst\u001b[39m connected \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m store\u001b[33m.\u001b[39mconnect()\u001b[33m;\u001b[39m\u001b[0m\n\n      at lib/tsa/tests/RedisStore.test.ts:45:5\n      at lib/tsa/tests/RedisStore.test.ts:31:3\n      at Object.<anonymous> (lib/tsa/tests/RedisStore.test.ts:15:1)\n\n  ● RedisStore ? [TSA-001] Redis连接建立 ? 超时情况下应切换到内存降级\n\n    thrown: \"Exceeded timeout of 5000 ms for a test.\n    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout.\"\n\n    \u001b[0m \u001b[90m 52 |\u001b[39m     })\u001b[33m;\u001b[39m\n     \u001b[90m 53 |\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 54 |\u001b[39m     it(\u001b[32m'超时情况下应切换到内存降级'\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\n     \u001b[90m    |\u001b[39m     \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 55 |\u001b[39m       (fetch \u001b[36mas\u001b[39m jest\u001b[33m.\u001b[39m\u001b[33mMock\u001b[39m)\u001b[33m.\u001b[39mmockImplementationOnce(() \u001b[33m=>\u001b[39m \n     \u001b[90m 56 |\u001b[39m         \u001b[36mnew\u001b[39m \u001b[33mPromise\u001b[39m((_\u001b[33m,\u001b[39m reject) \u001b[33m=>\u001b[39m \n     \u001b[90m 57 |\u001b[39m           setTimeout(() \u001b[33m=>\u001b[39m reject(\u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Timeout'\u001b[39m))\u001b[33m,\u001b[39m \u001b[35m10000\u001b[39m)\u001b[0m\n\n      at lib/tsa/tests/RedisStore.test.ts:54:5\n      at lib/tsa/tests/RedisStore.test.ts:31:3\n      at Object.<anonymous> (lib/tsa/tests/RedisStore.test.ts:15:1)\n\n  ● RedisStore ? 降级模式 ? 无配置时应自动使用内存存储\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: true\n    Received: false\n\n    \u001b[0m \u001b[90m 194 |\u001b[39m       \u001b[36mconst\u001b[39m connected \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m noConfigStore\u001b[33m.\u001b[39mconnect()\u001b[33m;\u001b[39m\n     \u001b[90m 195 |\u001b[39m       expect(connected)\u001b[33m.\u001b[39mtoBe(\u001b[36mtrue\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 196 |\u001b[39m       expect(noConfigStore\u001b[33m.\u001b[39misUsingFallback())\u001b[33m.\u001b[39mtoBe(\u001b[36mtrue\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                                               \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 197 |\u001b[39m\n     \u001b[90m 198 |\u001b[39m       \u001b[90m// 数据操作应该正常\u001b[39m\n     \u001b[90m 199 |\u001b[39m       \u001b[36mawait\u001b[39m noConfigStore\u001b[33m.\u001b[39m\u001b[36mset\u001b[39m(\u001b[32m'key'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'value'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      at Object.<anonymous> (lib/tsa/tests/RedisStore.test.ts:196:47)\n\n  ● RedisStore ? 错误处理 ? 应该处理网络错误并切换到降级\n\n    thrown: \"Exceeded timeout of 5000 ms for a test.\n    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout.\"\n\n    \u001b[0m \u001b[90m 298 |\u001b[39m\n     \u001b[90m 299 |\u001b[39m   describe(\u001b[32m'错误处理'\u001b[39m\u001b[33m,\u001b[39m () \u001b[33m=>\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 300 |\u001b[39m     it(\u001b[32m'应该处理网络错误并切换到降级'\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\n     \u001b[90m     |\u001b[39m     \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 301 |\u001b[39m       \u001b[90m// 先连接\u001b[39m\n     \u001b[90m 302 |\u001b[39m       (fetch \u001b[36mas\u001b[39m jest\u001b[33m.\u001b[39m\u001b[33mMock\u001b[39m)\u001b[33m.\u001b[39mmockResolvedValue({\n     \u001b[90m 303 |\u001b[39m         ok\u001b[33m:\u001b[39m \u001b[36mtrue\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\n\n      at lib/tsa/tests/RedisStore.test.ts:300:5\n      at lib/tsa/tests/RedisStore.test.ts:299:3\n      at Object.<anonymous> (lib/tsa/tests/RedisStore.test.ts:15:1)\n\n  ● TSA Integration ? 应该初始化并报告状态\n\n    TypeError: TSA.getStatus is not a function\n\n    \u001b[0m \u001b[90m 344 |\u001b[39m     \u001b[36mawait\u001b[39m \u001b[33mTSA\u001b[39m\u001b[33m.\u001b[39minit()\u001b[33m;\u001b[39m\n     \u001b[90m 345 |\u001b[39m     \n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 346 |\u001b[39m     \u001b[36mconst\u001b[39m status \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mTSA\u001b[39m\u001b[33m.\u001b[39mgetStatus()\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                              \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 347 |\u001b[39m     \n     \u001b[90m 348 |\u001b[39m     expect(status\u001b[33m.\u001b[39minitialized)\u001b[33m.\u001b[39mtoBe(\u001b[36mtrue\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m 349 |\u001b[39m     expect(status\u001b[33m.\u001b[39mbackend)\u001b[33m.\u001b[39mtoBeDefined()\u001b[33m;\u001b[39m\u001b[0m\n\n      at Object.<anonymous> (lib/tsa/tests/RedisStore.test.ts:346:30)\n","name":"F:\\Hajimi Code Ultra\\lib\\tsa\\tests\\RedisStore.test.ts","startTime":1771053870054,"status":"failed","summary":""}],"wasInterrupted":false}
