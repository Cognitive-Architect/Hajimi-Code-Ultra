# Alice ONNX åŠ¨æ€é‡åŒ–æ¶æ„è®¾è®¡

> **å·¥å•**: HAJIMI-DEBT-CLEARANCE-001-LAZY-MVP B-04/09  
> **ä½œè€…**: å”éŸ³ (Engineer)  
> **ç‰ˆæœ¬**: v1.0.0  
> **æ—¥æœŸ**: 2026-02-17

---

## 1. è®¾è®¡ç›®æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | éªŒæ”¶æ ‡å‡† |
|:---|:---|:---|
| é‡åŒ–å»¶è¿Ÿ | <5ms | QUANT-ARCH-001 |
| ç²¾åº¦æŸå¤± | <2% | QUANT-ARCH-002 |
| æ¨¡å‹å‹ç¼©ç‡ | FP32çš„25% | INT8 = 1/4 FP32 |
| è¿è¡Œæ—¶å†…å­˜ | <50MB | å«æ¨¡å‹+ä¸­é—´å¼ é‡ |
| å›é€€å¯é æ€§ | 100% | QUANT-ARCH-003 |

---

## 2. æ¶æ„æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Alice Quantization Runtime                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ FP32 Model  â”‚â”€â”€â”€â–¶â”‚ Calibration â”‚â”€â”€â”€â–¶â”‚  Dynamic Quantizer  â”‚ â”‚
â”‚  â”‚  (~200KB)   â”‚    â”‚  (1000æ¡)   â”‚    â”‚    (FP32â†’INT8)      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                  â”‚               â”‚
â”‚                                                  â–¼               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              Quantized INT8 Model (~50KB)                â”‚    â”‚
â”‚  â”‚  â€¢ æƒé‡: INT8å¯¹ç§°é‡åŒ– (scale, zero_point)                â”‚    â”‚
â”‚  â”‚  â€¢ æ¿€æ´»: è¿è¡Œæ—¶åŠ¨æ€æ ¡å‡† (per-tensor)                     â”‚    â”‚
â”‚  â”‚  â€¢ ç®—å­: Conv, MatMul, ReLU æ”¯æŒINT8                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                      â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚          â–¼               â–¼               â–¼                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  WebGL INT8  â”‚ â”‚  WASM INT8   â”‚ â”‚  CPU INT8    â”‚             â”‚
â”‚  â”‚   Backend    â”‚ â”‚   Backend    â”‚ â”‚   Backend    â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Fallback Monitor: ç²¾åº¦æŸå¤±>5% â†’ è‡ªåŠ¨å›é€€FP32            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. åŠ¨æ€é‡åŒ–ç­–ç•¥

### 3.1 é‡åŒ–æ–¹æ¡ˆé€‰æ‹©

| æ–¹æ¡ˆ | å»¶è¿Ÿ | ç²¾åº¦ | é€‚ç”¨åœºæ™¯ |
|:---|:---:|:---:|:---|
| **åŠ¨æ€é‡åŒ– (Dynamic)** | <5ms | é«˜ | **é€‰ä¸­** - è¿è¡Œæ—¶æ¿€æ´»æ ¡å‡† |
| é™æ€é‡åŒ– (Static) | 0ms | ä¸­ | é¢„æ ¡å‡†ï¼Œè¾¹ç¼˜è®¾å¤‡ |
| é‡åŒ–æ„ŸçŸ¥è®­ç»ƒ (QAT) | N/A | æœ€é«˜ | éœ€è¦é‡æ–°è®­ç»ƒ |

**å†³ç­–**: é‡‡ç”¨ **åŠ¨æ€é‡åŒ– (Dynamic Quantization)**
- ç†ç”±: è¿è¡Œæ—¶æ ¹æ®è¾“å…¥åˆ†å¸ƒåŠ¨æ€è®¡ç®—æ¿€æ´»ç¼©æ”¾å› å­
- ä¼˜åŠ¿: æ— éœ€ç¦»çº¿æ ¡å‡†æ•°æ®é›†ï¼Œé€‚åº”æ€§å¼º

### 3.2 é‡åŒ–å…¬å¼

```
å¯¹ç§°é‡åŒ– (æƒé‡):
  scale = max(|w|) / 127
  w_int8 = round(w / scale)
  w_deq = w_int8 * scale

éå¯¹ç§°é‡åŒ– (æ¿€æ´»):
  scale = (max - min) / 255
  zero_point = round(-min / scale)
  x_int8 = round(x / scale) + zero_point
```

### 3.3 é‡åŒ–ç²’åº¦

| å±‚çº§ | é…ç½® | å»¶è¿Ÿå½±å“ | ç²¾åº¦ |
|:---|:---|:---:|:---:|
| Per-tensor | æ¯æ•´ä¸ªå¼ é‡ä¸€ä¸ªscale | æœ€ä½ | ä¸­ç­‰ |
| Per-channel | æ¯è¾“å‡ºé€šé“ä¸€ä¸ªscale | ä½ | **é«˜** |
| Per-group | æ¯Kä¸ªå…ƒç´ ä¸€ä¸ªscale | ä¸­ | æ›´é«˜ |

**å†³ç­–**: æƒé‡ä½¿ç”¨ **Per-channel**ï¼Œæ¿€æ´»ä½¿ç”¨ **Per-tensor**

---

## 4. æ ¡å‡†æ•°æ®æµæ°´çº¿

### 4.1 æ•°æ®æ¥æº

```
B-08 åˆæˆè½¨è¿¹ç”Ÿæˆå™¨
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1000æ¡åˆæˆè½¨è¿¹  â”‚
â”‚  (6ç±»è¡Œä¸ºå‡è¡¡)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç‰¹å¾æå–å™¨      â”‚
â”‚  12ç»´å½’ä¸€åŒ–å‘é‡  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ ¡å‡†æ•°æ®é›†      â”‚â”€â”€â”€â”€â–¶â”‚  å­˜å‚¨è‡³ storage/ â”‚
â”‚  1000Ã—12çŸ©é˜µ    â”‚     â”‚  quantized/      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 æ ¡å‡†æ•°æ®æ ¼å¼

```typescript
// æ ¡å‡†æ•°æ®æ¥å£å®šä¹‰ (å‚è§ lib/alice/quantization-config.ts)
interface CalibrationDataset {
  version: string;
  generatedAt: string;
  totalSamples: number;
  samples: CalibrationSample[];
  statistics: CalibrationStatistics;
}

interface CalibrationSample {
  features: NormalizedFeatures;  // 12ç»´ [0,1]
  expectedBehavior?: BehaviorClass;
  trajectoryId: string;
}
```

### 4.3 æ ¡å‡†ç­–ç•¥

| ç­–ç•¥ | æ ·æœ¬æ•° | è¦†ç›–èŒƒå›´ | ç”¨é€” |
|:---|:---:|:---|:---|
| Min-Max | 100 | æå€¼èŒƒå›´ | å¿«é€Ÿæ ¡å‡† |
| KLæ•£åº¦ | 500 | åˆ†å¸ƒæ‹Ÿåˆ | æ ‡å‡†æ ¡å‡† |
| **ç™¾åˆ†ä½** | 1000 | 99.9%èŒƒå›´ | **é€‰ä¸­** - é²æ£’æ€§ |

---

## 5. ç²¾åº¦ä¿éšœæœºåˆ¶

### 5.1 ç²¾åº¦éªŒè¯æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FP32 æ¨ç†     â”‚â”€â”€â”
â”‚  (åŸºå‡†è¾“å‡º)     â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”œâ”€â”€â–¶  ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  similarity =   â”‚
â”‚   INT8 æ¨ç†     â”‚â”€â”€â”˜  â”‚  (fpÂ·int8)      â”‚
â”‚  (é‡åŒ–è¾“å‡º)     â”‚     â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  |fp|Ã—|int8|    â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼            â–¼            â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ >0.98    â”‚  â”‚ 0.95-0.98â”‚  â”‚ <0.95    â”‚
            â”‚ æ¥å—     â”‚  â”‚ è­¦å‘Š     â”‚  â”‚ æ‹’ç»     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ç²¾åº¦é˜ˆå€¼

| æŒ‡æ ‡ | é˜ˆå€¼ | åŠ¨ä½œ |
|:---|:---:|:---|
| ä½™å¼¦ç›¸ä¼¼åº¦ | â‰¥0.98 | âœ… æ¥å—é‡åŒ– |
| ä½™å¼¦ç›¸ä¼¼åº¦ | 0.95-0.98 | âš ï¸ è­¦å‘Šï¼Œç»§ç»­ä½¿ç”¨ |
| ä½™å¼¦ç›¸ä¼¼åº¦ | <0.95 | âŒ å›é€€FP32 |
| Top-1 å‡†ç¡®ç‡ä¸‹é™ | <2% | âœ… æ¥å— |
| Top-1 å‡†ç¡®ç‡ä¸‹é™ | >5% | âŒ å›é€€FP32 |

---

## 6. å›é€€æœºåˆ¶

### 6.1 è‡ªåŠ¨å›é€€è§¦å‘æ¡ä»¶

```typescript
enum FallbackTrigger {
  // ç²¾åº¦ç›¸å…³
  SIMILARITY_TOO_LOW = 'similarity_low',      // ä½™å¼¦ç›¸ä¼¼åº¦<0.95
  ACCURACY_DROP = 'accuracy_drop',            // å‡†ç¡®ç‡ä¸‹é™>5%
  
  // æ€§èƒ½ç›¸å…³
  QUANTIZATION_TIMEOUT = 'quant_timeout',     // é‡åŒ–è€—æ—¶>5ms
  INFERENCE_SLOW = 'inference_slow',          // æ¨ç†å»¶è¿Ÿ>25ms
  
  // å¼‚å¸¸ç›¸å…³
  MEMORY_PRESSURE = 'memory_pressure',        // å†…å­˜>50MB
  RUNTIME_ERROR = 'runtime_error',            // è¿è¡Œæ—¶é”™è¯¯
}
```

### 6.2 å›é€€ç­–ç•¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         é‡åŒ–å¼•æ“è¿è¡ŒçŠ¶æ€ç›‘æ§            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼            â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­£å¸¸   â”‚   â”‚ è­¦å‘Š   â”‚   â”‚ å¼‚å¸¸   â”‚
â”‚       â”‚   â”‚        â”‚   â”‚        â”‚
â”‚ç›¸ä¼¼åº¦  â”‚   â”‚ç›¸ä¼¼åº¦  â”‚   â”‚ç›¸ä¼¼åº¦  â”‚
â”‚>0.98  â”‚   â”‚0.95-0.98â”‚  â”‚<0.95  â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
    â”‚           â”‚            â”‚
    â–¼           â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ä½¿ç”¨INT8â”‚   â”‚ç»§ç»­INT8â”‚   â”‚å›é€€FP32â”‚
â”‚       â”‚   â”‚è®°å½•æ—¥å¿—â”‚   â”‚è‡ªåŠ¨åˆ‡æ¢â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  å›é€€åç›‘æ§      â”‚
                    â”‚  æ¯10æ¬¡æ¨ç†      â”‚
                    â”‚  æ£€æµ‹æ˜¯å¦æ¢å¤    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 å›é€€æ¢å¤æœºåˆ¶

| çŠ¶æ€ | æ£€æµ‹é¢‘ç‡ | æ¢å¤æ¡ä»¶ |
|:---|:---:|:---|
| FP32å›é€€æ¨¡å¼ | æ¯10æ¬¡æ¨ç† | è¿ç»­10æ¬¡INT8ç›¸ä¼¼åº¦>0.98 |
| è½¯æ¢å¤ | å®æ—¶ | å†…å­˜<40MB && å»¶è¿Ÿ<20ms |

---

## 7. å†…å­˜ä¼˜åŒ–

### 7.1 å†…å­˜é¢„ç®—åˆ†é…

| ç»„ä»¶ | é¢„ç®— | è¯´æ˜ |
|:---|:---:|:---|
| INT8æ¨¡å‹æƒé‡ | 25KB | åŸFP32 200KB â†’ 1/8 |
| ç¼©æ”¾å› å­è¡¨ | 5KB | per-channel scale |
| ä¸­é—´å¼ é‡ | 15KB | æ¿€æ´»å€¼INT8å­˜å‚¨ |
| è¿è¡Œæ—¶ç¼“å†² | 5KB | ä¸´æ—¶è®¡ç®—ç©ºé—´ |
| **æ€»è®¡** | **<50MB** | è¿œä½äºWebGLé™åˆ¶ |

### 7.2 å†…å­˜ä¼˜åŒ–ç­–ç•¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           å†…å­˜ä¼˜åŒ–æŠ€æœ¯                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. æƒé‡å…±äº«: ç›¸åŒç¼©æ”¾å› å­çš„æƒé‡å…±äº«å­˜å‚¨   â”‚
â”‚ 2. æ¿€æ´»å¤ç”¨: ç®—å­é“¾å¤ç”¨ä¸­é—´å¼ é‡ç¼“å†²åŒº     â”‚
â”‚ 3. å»¶è¿Ÿåé‡åŒ–: ä»…åœ¨éœ€è¦æ—¶åé‡åŒ–åˆ°FP32     â”‚
â”‚ 4. åˆ†å—è®¡ç®—: å¤§çŸ©é˜µåˆ†å—ï¼Œé™ä½å³°å€¼å†…å­˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. æ¥å£è®¾è®¡

### 8.1 æ ¸å¿ƒAPI

```typescript
// å‚è§ lib/alice/quantization-config.ts

class AliceQuantizationEngine {
  // åˆå§‹åŒ–
  async initialize(config: QuantizationConfig): Promise<boolean>;
  
  // åŠ¨æ€é‡åŒ–
  async quantize(
    fp32Model: ArrayBuffer,
    calibrationData: CalibrationDataset
  ): Promise<QuantizationResult>;
  
  // æ¨ç† (è‡ªåŠ¨é€‰æ‹©INT8/FP32)
  async infer(features: NormalizedFeatures): Promise<InferenceResult>;
  
  // è·å–å½“å‰çŠ¶æ€
  getStatus(): QuantizationStatus;
  
  // å¼ºåˆ¶å›é€€/æ¢å¤
  forceFallback(useFp32: boolean): void;
}
```

### 8.2 é…ç½®é€‰é¡¹

```typescript
interface QuantizationConfig {
  // é‡åŒ–ç­–ç•¥
  strategy: 'dynamic' | 'static';
  weightScheme: 'symmetric' | 'asymmetric';
  activationScheme: 'symmetric' | 'asymmetric';
  
  // ç²’åº¦
  weightGranularity: 'per-tensor' | 'per-channel';
  activationGranularity: 'per-tensor' | 'per-token';
  
  // é˜ˆå€¼
  similarityThreshold: number;  // é»˜è®¤0.98
  fallbackThreshold: number;    // é»˜è®¤0.95
  maxLatencyMs: number;         // é»˜è®¤5ms
  maxMemoryMB: number;          // é»˜è®¤50MB
  
  // æ ¡å‡†
  calibrationSamples: number;   // é»˜è®¤1000
  calibrationStrategy: 'min-max' | 'kl' | 'percentile';
}
```

---

## 9. è‡ªæµ‹æ ‡å‡†

### QUANT-ARCH-001: é‡åŒ–å»¶è¿Ÿ<5ms

```typescript
// æµ‹è¯•ç”¨ä¾‹
test('quantization latency < 5ms', async () => {
  const engine = new AliceQuantizationEngine();
  await engine.initialize(DEFAULT_CONFIG);
  
  const start = performance.now();
  const result = await engine.quantize(fp32Model, calibrationData);
  const latency = performance.now() - start;
  
  expect(latency).toBeLessThan(5);
  expect(result.success).toBe(true);
});
```

### QUANT-ARCH-002: ç²¾åº¦æŸå¤±<2%

```typescript
// æµ‹è¯•ç”¨ä¾‹
test('precision loss < 2%', async () => {
  const engine = new AliceQuantizationEngine();
  await engine.initialize(DEFAULT_CONFIG);
  
  const result = await engine.quantize(fp32Model, calibrationData);
  
  // ä½™å¼¦ç›¸ä¼¼åº¦ > 0.98
  expect(result.metrics.cosineSimilarity).toBeGreaterThan(0.98);
  
  // å‡†ç¡®ç‡ä¸‹é™ < 2%
  expect(result.metrics.accuracyDrop).toBeLessThan(0.02);
});
```

### QUANT-ARCH-003: å›é€€æœºåˆ¶å¯é 

```typescript
// æµ‹è¯•ç”¨ä¾‹
test('fallback mechanism works', async () => {
  const engine = new AliceQuantizationEngine();
  await engine.initialize({
    ...DEFAULT_CONFIG,
    similarityThreshold: 0.99, // è®¾ç½®é«˜é˜ˆå€¼è§¦å‘å›é€€
  });
  
  // æ¨¡æ‹Ÿä½ç²¾åº¦æƒ…å†µ
  const result = await engine.quantize(fp32Model, badCalibrationData);
  
  // åº”è‡ªåŠ¨å›é€€åˆ°FP32
  expect(engine.getStatus().mode).toBe('fp32');
  expect(engine.getStatus().fallbackTriggered).toBe(true);
  
  // æ¨ç†ä»èƒ½æ­£å¸¸è¿›è¡Œ
  const inference = await engine.infer(testFeatures);
  expect(inference).toBeDefined();
});
```

---

## 10. å®ç°è®¡åˆ’

| é˜¶æ®µ | ä»»åŠ¡ | å·¥æ—¶ | ä¾èµ– |
|:---|:---|:---:|:---|
| P0 | quantization-config.ts æ¥å£å®šä¹‰ | 2h | - |
| P0 | æ ¡å‡†æ•°æ®ç»“æ„å®šä¹‰ | 1h | B-08æ•°æ®æ ¼å¼ |
| P1 | åŠ¨æ€é‡åŒ–å¼•æ“æ ¸å¿ƒ | 8h | onnxruntime-web |
| P1 | WebGL INT8åç«¯é€‚é… | 4h | P0 |
| P1 | ç²¾åº¦éªŒè¯æ¨¡å— | 4h | P1 |
| P2 | å›é€€æœºåˆ¶å®ç° | 4h | P1 |
| P2 | å†…å­˜ä¼˜åŒ– | 4h | P1 |
| P3 | é›†æˆæµ‹è¯• | 4h | P2 |
| P3 | æ€§èƒ½åŸºå‡†æµ‹è¯• | 2h | P2 |

---

## 11. é£é™©è¯„ä¼°

| é£é™© | å¯èƒ½æ€§ | å½±å“ | ç¼“è§£æªæ–½ |
|:---|:---:|:---:|:---|
| WebGL INT8æ”¯æŒä¸å®Œå–„ | ä¸­ | é«˜ | å‡†å¤‡WASMå›é€€æ–¹æ¡ˆ |
| ç§»åŠ¨ç«¯ç²¾åº¦ä¸è¾¾æ ‡ | ä¸­ | é«˜ | è°ƒæ•´per-channelç²’åº¦ |
| æ ¡å‡†æ•°æ®ä¸è¶³ | ä½ | ä¸­ | å¢å¼ºB-08åˆæˆæ•°æ®ç”Ÿæˆ |
| å†…å­˜å³°å€¼è¶…é™ | ä½ | ä¸­ | åˆ†å—è®¡ç®—+ç¼“å†²åŒºå¤ç”¨ |

---

## 12. éªŒæ”¶æ¸…å•

- [ ] QUANT-ARCH-001: é‡åŒ–å»¶è¿Ÿ<5ms
- [ ] QUANT-ARCH-002: ç²¾åº¦æŸå¤±<2%
- [ ] QUANT-ARCH-003: å›é€€æœºåˆ¶å¯é 
- [ ] æ¨¡å‹ä½“ç§¯å‹ç¼©è‡³25%
- [ ] è¿è¡Œæ—¶å†…å­˜<50MB
- [ ] 6ç±»è¡Œä¸ºå‡è¡¡è¦†ç›–
- [ ] ä»£ç è¦†ç›–ç‡>80%

---

**å”éŸ³ç¡®è®¤**: â˜ï¸ğŸ˜‹ğŸâ™¾ï¸ğŸ’¥
